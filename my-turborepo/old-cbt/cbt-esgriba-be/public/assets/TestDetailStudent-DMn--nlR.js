var C=(d,o,h)=>new Promise((p,s)=>{var v=t=>{try{c(h.next(t))}catch(m){s(m)}},a=t=>{try{c(h.throw(t))}catch(m){s(m)}},c=t=>t.done?p(t.value):Promise.resolve(t.value).then(v,a);c((h=h.apply(d,o)).next())});import{j as e}from"./vendor-ui-XVksrZ5j.js";import{h as W,u as X,r as x}from"./vendor-react-DruPVAFJ.js";import{f as q,e as T,B as u,C as D,d as S,a as L,b as P}from"./index-BmVdEGiP.js";import{B}from"./badge-DVlZ2whw.js";import{A as g,a as N}from"./alert-BAo0Ym_t.js";import{A as Y,a as G,b as Q,c as V,d as Z,e as ee,f as se,g as ae}from"./alert-dialog-DeGwCm2P.js";import{A as U}from"./alert-circle-Cjt8dlsE.js";import{F as M}from"./file-text-8Keq495L.js";import{C as b}from"./clock-eO0sA20s.js";import{P as F}from"./play-circle-DOrl6LA7.js";import{C as j}from"./check-circle-BdZ4TSjl.js";import{B as te}from"./book-open-CXdsRrc-.js";import{A as E}from"./award-DWPfopPw.js";import{X as _}from"./x-circle-Czjy44Dj.js";import{f as I}from"./vendor-utils-DI_-nBMo.js";import{i as z}from"./id-mgxg9YzS.js";import"./vendor-charts-BB9d_U7u.js";/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const H=q("Info",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]]);function we(){const{id:d}=W(),o=X(),[h,p]=x.useState(!0),[s,v]=x.useState(null),[a,c]=x.useState(null),[t,m]=x.useState(null),[J,w]=x.useState(!1),[f,$]=x.useState(!1);x.useEffect(()=>{K()},[d]);const K=()=>C(this,null,function*(){try{p(!0);const n=yield T.get(`/tests/${d}`);v(n.data.test||n.data);try{const r=yield T.get(`/attempts?test_id=${d}`);console.log("Attempts response:",r.data);let i=[];if(r.data.data&&Array.isArray(r.data.data)?i=r.data.data:Array.isArray(r.data)&&(i=r.data),console.log("Processed attempts:",i),i&&i.length>0){const k=i.find(A=>A.status==="in_progress");k&&(console.log("Found in-progress attempt:",k),m(k));const y=i.find(A=>A.status==="completed");y&&(console.log("Found completed attempt:",y),c(y))}else console.log("No attempts found for this test"),m(null),c(null)}catch(r){console.log("Error fetching attempts:",r),m(null),c(null)}}catch(n){console.error("Failed to fetch test detail:",n)}finally{p(!1)}}),O=()=>C(this,null,function*(){try{$(!0),o(`/tests/${d}/take`)}catch(n){console.error("Failed to start test:",n)}finally{$(!1),w(!1)}}),R=()=>{if(!s)return null;const n=s.server_time?new Date(s.server_time):new Date,r=new Date(s.start_time),i=new Date(s.end_time);return n<r?{status:"upcoming",message:`Akan dimulai ${I(r,{addSuffix:!0,locale:z})}`,color:"blue"}:n>i?{status:"finished",message:"Ujian telah berakhir",color:"gray"}:{status:"active",message:`Berakhir ${I(i,{addSuffix:!0,locale:z})}`,color:"green"}};if(h)return e.jsx("div",{className:"flex items-center justify-center min-h-[500px]",children:e.jsxs("div",{className:"text-center space-y-4",children:[e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"animate-spin rounded-full h-16 w-16 border-b-4 border-t-4 border-blue-600 mx-auto"}),e.jsx("div",{className:"absolute inset-0 rounded-full h-16 w-16 border-4 border-blue-100 mx-auto"})]}),e.jsx("p",{className:"text-lg font-medium text-slate-600 animate-pulse",children:"Memuat detail ujian..."})]})});if(!s)return e.jsx("div",{className:"flex items-center justify-center min-h-[400px]",children:e.jsxs(g,{variant:"destructive",children:[e.jsx(U,{className:"h-4 w-4"}),e.jsx(N,{children:"Ujian tidak ditemukan"})]})});const l=R();return e.jsxs("div",{className:"max-w-4xl mx-auto p-4 md:p-6 space-y-6 pb-10",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsx(u,{variant:"ghost",onClick:()=>o("/tests"),className:"mb-2 hover:bg-slate-100 transition-colors gap-2",children:"‚Üê Kembali ke Daftar Ujian"}),e.jsxs(D,{className:"border-0 bg-gradient-to-br from-blue-600 via-indigo-600 to-purple-600 text-white shadow-2xl overflow-hidden",children:[e.jsx("div",{className:"absolute inset-0 bg-grid-white/10 [mask-image:linear-gradient(0deg,transparent,rgba(255,255,255,0.6))]"}),e.jsx(S,{className:"relative p-6 md:p-8",children:e.jsxs("div",{className:"flex items-start gap-4 mb-4",children:[e.jsx("div",{className:"p-3 bg-white/20 backdrop-blur-sm rounded-2xl",children:e.jsx(M,{className:"w-8 h-8 text-white"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h1",{className:"text-2xl md:text-3xl font-bold mb-3",children:s.title}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsx(B,{className:`${s.is_active?"bg-green-500 hover:bg-green-600":"bg-gray-500"} text-white border-0`,children:s.is_active?"‚úì Aktif":"‚óã Tidak Aktif"}),l&&e.jsxs(B,{className:`border-0 text-white
                        ${l.color==="green"?"bg-emerald-500 hover:bg-emerald-600":""}
                        ${l.color==="blue"?"bg-blue-400 hover:bg-blue-500":""}
                        ${l.color==="gray"?"bg-gray-400 hover:bg-gray-500":""}
                      `,children:[e.jsx(b,{className:"w-3 h-3 mr-1"}),l.message]})]})]})]})})]})]}),t&&e.jsx(g,{className:"border-2 border-blue-500 bg-gradient-to-r from-blue-50 to-indigo-50 shadow-lg",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"p-2 bg-blue-500 rounded-lg",children:e.jsx(b,{className:"h-5 w-5 text-white animate-pulse"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"font-semibold text-blue-900 mb-1",children:"Ujian Sedang Berlangsung"}),e.jsx("p",{className:"text-blue-700 text-sm",children:"Anda memiliki ujian yang sedang berlangsung. Klik tombol di bawah untuk melanjutkan."}),e.jsxs(u,{size:"sm",className:"mt-3 bg-blue-600 hover:bg-blue-700 text-white gap-2",onClick:()=>o(`/tests/${d}/take`),children:[e.jsx(F,{className:"w-4 h-4"}),"Lanjutkan Ujian Sekarang"]})]})]})}),a&&!t&&e.jsx(g,{className:`border-2 shadow-lg ${a.is_passed?"border-green-500 bg-gradient-to-r from-green-50 to-emerald-50":"border-amber-500 bg-gradient-to-r from-amber-50 to-yellow-50"}`,children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:`p-2 rounded-lg ${a.is_passed?"bg-green-500":"bg-amber-500"}`,children:a.is_passed?e.jsx(j,{className:"h-5 w-5 text-white"}):e.jsx(U,{className:"h-5 w-5 text-white"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:`font-semibold mb-1 ${a.is_passed?"text-green-900":"text-amber-900"}`,children:a.is_passed?"üéâ Selamat! Anda Lulus":"üìù Hasil Ujian Sebelumnya"}),e.jsxs("p",{className:`text-sm ${a.is_passed?"text-green-700":"text-amber-700"}`,children:["Nilai Anda:"," ",e.jsx("strong",{className:"text-lg",children:Number(a.score).toFixed(1)})," ","-",a.is_passed?" LULUS ‚úì":" BELUM LULUS"]}),a.status==="completed"&&e.jsx(u,{variant:"link",size:"sm",className:`p-0 h-auto mt-2 ${a.is_passed?"text-green-600 hover:text-green-700":"text-amber-600 hover:text-amber-700"}`,onClick:()=>o(`/results/${a.id}`),children:"Lihat Detail Hasil ‚Üí"})]})]})}),e.jsxs(D,{className:"border-0 shadow-xl",children:[e.jsx(L,{className:"bg-gradient-to-r from-slate-50 to-blue-50 border-b",children:e.jsxs(P,{className:"flex items-center gap-3 text-xl",children:[e.jsx("div",{className:"p-2 bg-blue-100 rounded-xl",children:e.jsx(H,{className:"h-5 w-5 text-blue-600"})}),"Informasi Ujian"]})}),e.jsxs(S,{className:"p-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"flex items-start gap-4 p-4 bg-gradient-to-br from-blue-50 to-indigo-50 rounded-xl",children:[e.jsx("div",{className:"p-2 bg-blue-500 rounded-lg",children:e.jsx(te,{className:"h-5 w-5 text-white"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-blue-600 font-medium mb-1",children:"Mata Pelajaran"}),e.jsx("p",{className:"font-bold text-blue-900 text-lg",children:s.subject})]})]}),e.jsxs("div",{className:"flex items-start gap-4 p-4 bg-gradient-to-br from-emerald-50 to-teal-50 rounded-xl",children:[e.jsx("div",{className:"p-2 bg-emerald-500 rounded-lg",children:e.jsx(b,{className:"h-5 w-5 text-white"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-emerald-600 font-medium mb-1",children:"Durasi Ujian"}),e.jsxs("p",{className:"font-bold text-emerald-900 text-lg",children:[s.duration," menit"]})]})]}),e.jsxs("div",{className:"flex items-start gap-4 p-4 bg-gradient-to-br from-amber-50 to-orange-50 rounded-xl",children:[e.jsx("div",{className:"p-2 bg-amber-500 rounded-lg",children:e.jsx(M,{className:"h-5 w-5 text-white"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-amber-600 font-medium mb-1",children:"Jumlah Soal"}),e.jsxs("p",{className:"font-bold text-amber-900 text-lg",children:[s.total_questions||0," soal"]})]})]})]}),s.teacher&&e.jsx("div",{className:"mt-6 pt-6 border-t border-slate-200",children:e.jsxs("div",{className:"flex items-center gap-3 p-4 bg-gradient-to-r from-slate-50 to-gray-50 rounded-xl",children:[e.jsx("div",{className:"p-2 bg-slate-600 rounded-lg",children:e.jsx(E,{className:"h-5 w-5 text-white"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-slate-500 font-medium",children:"Dibuat oleh"}),e.jsx("p",{className:"font-bold text-slate-900",children:s.teacher.name})]})]})})]})]}),e.jsxs(D,{className:"border-0 shadow-xl",children:[e.jsx(L,{className:"bg-gradient-to-r from-indigo-50 to-purple-50 border-b",children:e.jsxs(P,{className:"flex items-center gap-3 text-xl",children:[e.jsx("div",{className:"p-2 bg-indigo-100 rounded-xl",children:e.jsx(H,{className:"h-5 w-5 text-indigo-600"})}),"Petunjuk Pengerjaan"]})}),e.jsx(S,{className:"p-6",children:e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-start gap-3 p-3 bg-green-50 rounded-lg hover:bg-green-100 transition-colors",children:[e.jsx(j,{className:"h-5 w-5 text-green-600 mt-0.5 flex-shrink-0"}),e.jsxs("span",{className:"text-slate-700",children:["Pastikan koneksi internet Anda ",e.jsx("strong",{children:"stabil"})," sebelum memulai ujian"]})]}),e.jsxs("div",{className:"flex items-start gap-3 p-3 bg-green-50 rounded-lg hover:bg-green-100 transition-colors",children:[e.jsx(j,{className:"h-5 w-5 text-green-600 mt-0.5 flex-shrink-0"}),e.jsxs("span",{className:"text-slate-700",children:["Waktu pengerjaan adalah ",e.jsxs("strong",{children:[s.duration," menit"]})," ","sejak ujian dimulai"]})]}),e.jsxs("div",{className:"flex items-start gap-3 p-3 bg-green-50 rounded-lg hover:bg-green-100 transition-colors",children:[e.jsx(j,{className:"h-5 w-5 text-green-600 mt-0.5 flex-shrink-0"}),e.jsxs("span",{className:"text-slate-700",children:["Jawaban akan ",e.jsx("strong",{children:"tersimpan otomatis"})," setiap kali Anda menjawab"]})]}),e.jsxs("div",{className:"flex items-start gap-3 p-3 bg-green-50 rounded-lg hover:bg-green-100 transition-colors",children:[e.jsx(j,{className:"h-5 w-5 text-green-600 mt-0.5 flex-shrink-0"}),e.jsxs("span",{className:"text-slate-700",children:["Anda dapat ",e.jsx("strong",{children:"mengubah jawaban"})," selama waktu belum habis"]})]}),e.jsxs("div",{className:"flex items-start gap-3 p-3 bg-blue-50 rounded-lg hover:bg-blue-100 transition-colors",children:[e.jsx(E,{className:"h-5 w-5 text-blue-600 mt-0.5 flex-shrink-0"}),e.jsxs("span",{className:"text-slate-700",children:["Nilai minimal untuk lulus adalah"," ",e.jsx("strong",{className:"text-blue-600",children:s.passing_score})]})]}),e.jsxs("div",{className:"flex items-start gap-3 p-3 bg-red-50 rounded-lg hover:bg-red-100 transition-colors",children:[e.jsx(_,{className:"h-5 w-5 text-red-600 mt-0.5 flex-shrink-0"}),e.jsxs("span",{className:"text-slate-700",children:[e.jsx("strong",{children:"Jangan refresh"})," atau tutup halaman saat mengerjakan ujian"]})]}),e.jsxs("div",{className:"flex items-start gap-3 p-3 bg-red-50 rounded-lg hover:bg-red-100 transition-colors",children:[e.jsx(_,{className:"h-5 w-5 text-red-600 mt-0.5 flex-shrink-0"}),e.jsxs("span",{className:"text-slate-700",children:["Setelah submit, Anda ",e.jsx("strong",{children:"tidak dapat mengubah"})," ","jawaban lagi"]})]})]})})]}),e.jsx("div",{className:"flex justify-center pt-4",children:s.is_active?(l==null?void 0:l.status)==="upcoming"?e.jsxs(g,{className:"max-w-md border-2 border-blue-300 bg-blue-50",children:[e.jsx(b,{className:"h-5 w-5 text-blue-600"}),e.jsx(N,{className:"text-blue-900 text-base",children:"Ujian belum dimulai. Tunggu hingga waktu yang ditentukan."})]}):(l==null?void 0:l.status)==="finished"?e.jsxs(g,{variant:"destructive",className:"max-w-md border-2",children:[e.jsx(_,{className:"h-5 w-5"}),e.jsx(N,{className:"text-base",children:"Ujian telah berakhir dan tidak dapat dikerjakan lagi."})]}):t?e.jsxs(u,{size:"lg",className:"min-w-[240px] h-14 text-lg gap-3 bg-gradient-to-r from-blue-600 to-indigo-600 hover:from-blue-700 hover:to-indigo-700 shadow-xl hover:shadow-2xl transition-all duration-300 hover:-translate-y-1",onClick:()=>o(`/tests/${d}/take`),children:[e.jsx(b,{className:"h-6 w-6 animate-pulse"}),"Lanjutkan Ujian"]}):e.jsxs(u,{size:"lg",className:"min-w-[240px] h-14 text-lg gap-3 bg-gradient-to-r from-emerald-600 to-teal-600 hover:from-emerald-700 hover:to-teal-700 shadow-xl hover:shadow-2xl transition-all duration-300 hover:-translate-y-1",onClick:()=>w(!0),disabled:f,children:[e.jsx(F,{className:"h-6 w-6"}),a?"Kerjakan Lagi":"Mulai Ujian Sekarang"]}):e.jsxs(g,{variant:"destructive",className:"max-w-md border-2",children:[e.jsx(U,{className:"h-5 w-5"}),e.jsx(N,{className:"text-base",children:"Ujian ini belum diaktifkan oleh guru"})]})}),e.jsx(Y,{open:J,onOpenChange:w,children:e.jsxs(G,{children:[e.jsxs(Q,{children:[e.jsx(V,{children:"Mulai Ujian?"}),e.jsx(Z,{children:e.jsxs("div",{className:"space-y-2",children:[e.jsxs("p",{children:["Anda akan memulai ujian: ",e.jsx("strong",{children:s.title})]}),e.jsxs("p",{children:["Waktu pengerjaan: ",e.jsxs("strong",{children:[s.duration," menit"]})]}),e.jsx("p",{className:"text-yellow-600 font-medium",children:'‚ö†Ô∏è Timer akan dimulai segera setelah Anda klik "Mulai"'}),a&&e.jsxs("p",{className:"text-blue-600 font-medium",children:["‚ÑπÔ∏è Nilai sebelumnya:"," ",Number(a.score).toFixed(1)]})]})})]}),e.jsxs(ee,{children:[e.jsx(se,{disabled:f,children:"Batal"}),e.jsx(ae,{onClick:O,disabled:f,className:"bg-blue-600 hover:bg-blue-700",children:f?"Memulai...":"Ya, Mulai Sekarang"})]})]})})]})}export{we as default};
