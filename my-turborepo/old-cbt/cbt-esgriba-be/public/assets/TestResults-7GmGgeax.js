var Ie=Object.defineProperty,Re=Object.defineProperties;var Fe=Object.getOwnPropertyDescriptors;var U=Object.getOwnPropertySymbols;var pe=Object.prototype.hasOwnProperty,ue=Object.prototype.propertyIsEnumerable;var ge=(t,i,l)=>i in t?Ie(t,i,{enumerable:!0,configurable:!0,writable:!0,value:l}):t[i]=l,P=(t,i)=>{for(var l in i||(i={}))pe.call(i,l)&&ge(t,l,i[l]);if(U)for(var l of U(i))ue.call(i,l)&&ge(t,l,i[l]);return t},G=(t,i)=>Re(t,Fe(i));var ee=(t,i)=>{var l={};for(var m in t)pe.call(t,m)&&i.indexOf(m)<0&&(l[m]=t[m]);if(t!=null&&U)for(var m of U(t))i.indexOf(m)<0&&ue.call(t,m)&&(l[m]=t[m]);return l};var L=(t,i,l)=>new Promise((m,v)=>{var x=f=>{try{T(l.next(f))}catch(b){v(b)}},_=f=>{try{T(l.throw(f))}catch(b){v(b)}},T=f=>f.done?m(f.value):Promise.resolve(f.value).then(x,_);T((l=l.apply(t,i)).next())});import{j as e,_ as ve,$ as Je,a0 as He,a1 as _e,a2 as Ke}from"./vendor-ui-XVksrZ5j.js";import{r as g,h as ze,u as Ue}from"./vendor-react-DruPVAFJ.js";import{f as Ve,i as Se,u as ke,e as $,L as se,I as Ae,B as C,C as S,d as k,a as je,b as be}from"./index-BmVdEGiP.js";import{B as j}from"./badge-DVlZ2whw.js";import{T as We,a as Oe,b as ae,c as A,d as Xe,e as y}from"./table-BTQg55BV.js";import{S as Ye,a as Qe,b as Ze,c as es,d as V}from"./select-CT0oUeJ5.js";import{D as Ce,b as Te,c as Ee,d as De,f as ss,e as as}from"./dialog-FHcYl0q1.js";import{u as te,w as ts}from"./xlsx-Ccx-kdi7.js";import{M as W}from"./MathContent-BLSKFKlW.js";import{L as re,C as rs}from"./loader-2-DyIj99pk.js";import{C as Ne}from"./check-circle-BdZ4TSjl.js";import{X as qe}from"./x-circle-Czjy44Dj.js";import{A as ns}from"./arrow-left-C1WfDAGK.js";import{F as ls}from"./file-spreadsheet-BhItZ3XK.js";import{T as fe}from"./trending-up-WSJC20Jg.js";import{S as is}from"./search-NdQjMSfE.js";import{E as we}from"./eye-ErUhf9Bf.js";import{P as ye}from"./pen-square-DdkHHRrl.js";import"./vendor-utils-DI_-nBMo.js";import"./vendor-charts-BB9d_U7u.js";import"./chevron-down-CL3T_hsi.js";import"./check-BFyP0Qeo.js";import"./vendor-math-BWdfurLP.js";/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cs=Ve("TrendingDown",[["polyline",{points:"22 17 13.5 8.5 8.5 13.5 2 7",key:"1r2t7k"}],["polyline",{points:"16 17 22 17 22 11",key:"11uiuu"}]]),Be=g.forwardRef((v,m)=>{var x=v,{className:t,children:i}=x,l=ee(x,["className","children"]);return e.jsxs(ve,G(P({ref:m,className:Se("relative overflow-hidden",t)},l),{children:[e.jsx(Je,{className:"h-full w-full rounded-[inherit]",children:i}),e.jsx(Me,{}),e.jsx(He,{})]}))});Be.displayName=ve.displayName;const Me=g.forwardRef((v,m)=>{var x=v,{className:t,orientation:i="vertical"}=x,l=ee(x,["className","orientation"]);return e.jsx(_e,G(P({ref:m,orientation:i,className:Se("flex touch-none select-none transition-colors",i==="vertical"&&"h-full w-2.5 border-l border-l-transparent p-[1px]",i==="horizontal"&&"h-2.5 flex-col border-t border-t-transparent p-[1px]",t)},l),{children:e.jsx(Ke,{className:"relative flex-1 rounded-full bg-border"})}))});Me.displayName=_e.displayName;function ds({isOpen:t,onClose:i,testId:l,attemptId:m,studentName:v,onGradeSubmitted:x}){const{toast:_}=ke(),[T,f]=g.useState(!0),[b,E]=g.useState(!1),[B,O]=g.useState([]),[D,I]=g.useState({});g.useEffect(()=>{t&&m&&p()},[t,m]);const p=()=>L(this,null,function*(){var r,N;f(!0);try{const q=(yield $.get(`/tests/${l}/attempts/${m}/essays`)).data.essay_answers||[];O(q);const F={};q.forEach(J=>{F[J.answer_id]=J.points_earned||0}),I(F)}catch(u){_({title:"Error",description:((N=(r=u.response)==null?void 0:r.data)==null?void 0:N.message)||"Gagal memuat jawaban essay",variant:"destructive"})}finally{f(!1)}}),X=(r,N)=>{const u=parseInt(N)||0;I(q=>G(P({},q),{[r]:u}))},Y=r=>L(this,null,function*(){var N,u;E(!0);try{yield $.post(`/tests/${l}/attempts/${m}/essays/${r}/grade`,{points_earned:D[r]}),_({title:"Berhasil",description:"Nilai berhasil disimpan"}),yield p(),x()}catch(q){_({title:"Error",description:((u=(N=q.response)==null?void 0:N.data)==null?void 0:u.message)||"Gagal menyimpan nilai",variant:"destructive"})}finally{E(!1)}}),R=()=>L(this,null,function*(){var r,N;E(!0);try{for(const u of B)yield $.post(`/tests/${l}/attempts/${m}/essays/${u.answer_id}/grade`,{points_earned:D[u.answer_id]});_({title:"Berhasil",description:"Semua nilai berhasil disimpan"}),yield p(),x(),i()}catch(u){_({title:"Error",description:((N=(r=u.response)==null?void 0:r.data)==null?void 0:N.message)||"Gagal menyimpan nilai",variant:"destructive"})}finally{E(!1)}});return e.jsx(Ce,{open:t,onOpenChange:i,children:e.jsxs(Te,{className:"max-w-4xl max-h-[90vh]",children:[e.jsx(Ee,{children:e.jsxs(De,{children:["Penilaian Essay - ",v]})}),T?e.jsx("div",{className:"flex items-center justify-center py-8",children:e.jsx(re,{className:"h-8 w-8 animate-spin text-primary"})}):B.length===0?e.jsx("div",{className:"text-center py-8 text-muted-foreground",children:"Tidak ada soal essay dalam ujian ini"}):e.jsxs(e.Fragment,{children:[e.jsx(Be,{className:"max-h-[60vh] pr-4",children:e.jsx("div",{className:"space-y-6",children:B.map((r,N)=>e.jsxs("div",{className:"border rounded-lg p-4 space-y-4",children:[e.jsx("div",{className:"flex items-start justify-between",children:e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[e.jsxs(j,{variant:"outline",className:"text-base py-1",children:["Soal ",N+1]}),e.jsxs(j,{variant:"secondary",className:"bg-blue-100 text-blue-700",children:["Bobot: ",r.max_points," poin"]}),r.points_earned!==null&&e.jsxs(j,{className:r.points_earned>0?"bg-green-500 hover:bg-green-600":"bg-gray-400 hover:bg-gray-500",children:[r.points_earned>0?e.jsx(Ne,{className:"h-3 w-3 mr-1"}):e.jsx(qe,{className:"h-3 w-3 mr-1"}),"✓ ",r.points_earned," poin"]})]}),e.jsxs("div",{className:"bg-gray-50 border border-gray-200 rounded-lg p-4 mb-4",children:[e.jsx("p",{className:"text-xs font-semibold text-gray-600 mb-2",children:"PERTANYAAN:"}),e.jsx("div",{className:"text-sm text-gray-900",children:e.jsx(W,{content:r.question_text})})]})]})}),e.jsxs("div",{className:"bg-green-50 border-2 border-green-300 rounded-lg p-4 mb-3",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(Ne,{className:"h-4 w-4 text-green-600"}),e.jsx(se,{className:"text-sm text-green-700 font-bold",children:"KUNCI JAWABAN / JAWABAN YANG BENAR:"})]}),e.jsx("div",{className:"text-sm whitespace-pre-wrap text-green-900 leading-relaxed pl-6",children:r.expected_answer?e.jsx(W,{content:r.expected_answer}):e.jsx("span",{className:"text-gray-500 italic",children:"(Kunci jawaban belum diisi oleh guru saat membuat soal)"})})]}),e.jsxs("div",{className:"bg-blue-50 border-2 border-blue-300 rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx("div",{className:"h-4 w-4 rounded-full bg-blue-500 flex items-center justify-center",children:e.jsx("span",{className:"text-white text-xs font-bold",children:"S"})}),e.jsx(se,{className:"text-sm text-blue-700 font-bold",children:"JAWABAN SISWA:"})]}),e.jsx("div",{className:"text-sm whitespace-pre-wrap text-blue-900 leading-relaxed pl-6",children:r.answer_text||e.jsx("span",{className:"text-gray-500 italic",children:"Tidak dijawab"})})]}),e.jsxs("div",{className:"flex items-end gap-3 pt-4 border-t-2 border-gray-200",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx(se,{htmlFor:`score-${r.answer_id}`,className:"text-sm font-bold text-gray-700 mb-2 block",children:"BERIKAN NILAI:"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Ae,{id:`score-${r.answer_id}`,type:"number",min:"0",max:r.max_points,value:D[r.answer_id]||0,onChange:u=>X(r.answer_id,u.target.value),placeholder:"0",disabled:b,className:"text-lg font-semibold text-center"}),e.jsxs("span",{className:"text-gray-500 font-medium",children:["/ ",r.max_points]})]}),e.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:["Masukkan nilai antara 0 - ",r.max_points," poin"]})]}),e.jsx(C,{onClick:()=>Y(r.answer_id),disabled:b||D[r.answer_id]>r.max_points,className:"bg-blue-600 hover:bg-blue-700",children:b?e.jsx(re,{className:"h-4 w-4 animate-spin"}):"Simpan"})]})]},r.answer_id))})}),e.jsxs(ss,{children:[e.jsx(C,{variant:"outline",onClick:i,disabled:b,children:"Tutup"}),e.jsx(C,{onClick:R,disabled:b,children:b?e.jsxs(e.Fragment,{children:[e.jsx(re,{className:"h-4 w-4 mr-2 animate-spin"}),"Menyimpan..."]}):"Simpan Semua Nilai"})]})]})]})})}function Ms(){const{testId:t}=ze(),i=Ue(),{toast:l}=ke(),[m,v]=g.useState(!0),[x,_]=g.useState(null),[T,f]=g.useState([]),[b,E]=g.useState(null),[B,O]=g.useState(""),[D,I]=g.useState("all"),[p,X]=g.useState(null),[Y,R]=g.useState(!1),[r,N]=g.useState(!1),[u,q]=g.useState(null),[F,J]=g.useState("");g.useEffect(()=>{ne()},[t]);const Le=(s,c)=>s.map(a=>{const h=a.correct_answers||0,o=a.wrong_answers||0,d=a.total_points||0,n=a.max_points||c,w=a.percentage||0,H=a.total_answered||0,K=c-H;return{id:a.id,student:{id:a.user_id||0,name:a.student_name||"Unknown",nis:a.student_nis||"-",class:a.class_name?{name:a.class_name}:void 0},score:d,max_score:n,percentage:w,status:a.status||"completed",started_at:a.started_at||"",finished_at:a.finished_at||"",duration_minutes:a.duration_minutes||0,correct_answers:h,wrong_answers:o,unanswered:K}}),ne=()=>L(this,null,function*(){var s,c;try{v(!0);const a=yield $.get(`/tests/${t}`);_(a.data.data||a.data);const h=yield $.get(`/tests/${t}/results`);console.log("Attempts response:",h.data);let o=[];Array.isArray(h.data.data)?o=h.data.data:Array.isArray(h.data)?o=h.data:o=[],console.log("Processed attempts data:",o);const n=(a.data.data||a.data).total_questions||0,w=Le(o,n);console.log("Transformed attempts:",w),f(w),$e(w)}catch(a){console.error("Error loading test results:",a),l({title:"Error",description:((c=(s=a.response)==null?void 0:s.data)==null?void 0:c.message)||"Failed to load test results",variant:"destructive"}),f([])}finally{v(!1)}}),$e=s=>{if(!Array.isArray(s)||s.length===0){E({total_attempts:0,completed:0,in_progress:0,average_score:0,highest_score:0,lowest_score:0,pass_rate:0,average_duration:0});return}const c=s.filter(d=>d.status==="completed");if(c.length===0){E({total_attempts:s.length,completed:0,in_progress:s.filter(d=>d.status==="in_progress").length,average_score:0,highest_score:0,lowest_score:0,pass_rate:0,average_duration:0});return}const a=c.map(d=>d.percentage||0),h=c.map(d=>d.duration_minutes||0),o=c.filter(d=>d.percentage>=((x==null?void 0:x.passing_score)||75));E({total_attempts:s.length,completed:c.length,in_progress:s.filter(d=>d.status==="in_progress").length,average_score:a.length>0?a.reduce((d,n)=>d+n,0)/a.length:0,highest_score:a.length>0?Math.max(...a):0,lowest_score:a.length>0?Math.min(...a):0,pass_rate:c.length>0?o.length/c.length*100:0,average_duration:h.length>0?h.reduce((d,n)=>d+n,0)/h.length:0})},M=(Array.isArray(T)?T:[]).filter(s=>{var h,o,d,n;const c=((o=(h=s.student)==null?void 0:h.name)==null?void 0:o.toLowerCase().includes(B.toLowerCase()))||((n=(d=s.student)==null?void 0:d.nis)==null?void 0:n.toLowerCase().includes(B.toLowerCase())),a=D==="all"||s.status===D;return c&&a}),le=s=>{switch(s){case"completed":return e.jsx(j,{className:"bg-green-500",children:"Selesai"});case"in_progress":return e.jsx(j,{className:"bg-yellow-500",children:"Sedang Mengerjakan"});case"blocked":return e.jsx(j,{className:"bg-red-500",children:"Diblokir"});default:return e.jsx(j,{variant:"outline",children:s})}},ie=(s,c)=>s>=c?e.jsx(j,{className:"bg-green-500",children:"Lulus"}):e.jsx(j,{className:"bg-red-500",children:"Tidak Lulus"}),ce=s=>L(this,null,function*(){var c,a,h,o,d;try{const n=yield $.get(`/attempts/${s.id}`);console.log("Attempt detail:",n.data);const w=G(P({},n.data),{student:{name:((c=n.data.user)==null?void 0:c.name)||"",nis:((a=n.data.user)==null?void 0:a.nisn)||((h=n.data.user)==null?void 0:h.nis)||"",class:((o=n.data.user)==null?void 0:o.class_name)||((d=n.data.user)==null?void 0:d.kelas)||""},score:n.data.total_points||0,max_score:n.data.max_points||100,percentage:n.data.percentage||0,correct_answers:n.data.correct_answers||0,wrong_answers:n.data.wrong_answers||0,unanswered:n.data.unanswered||0,answers:n.data.answers||[]});X(w),R(!0)}catch(n){console.error("Failed to load attempt details:",n),l({title:"Error",description:"Gagal memuat detail jawaban",variant:"destructive"})}}),de=s=>{q(s.id),J(s.student.name),N(!0)},Pe=()=>{ne()},Ge=()=>{const s=M.map((o,d)=>{var n;return{No:d+1,NIS:o.student.nis,Nama:o.student.name,Kelas:((n=o.student.class)==null?void 0:n.name)||"-",Status:o.status==="completed"?"Selesai":"Sedang Mengerjakan",Nilai:Math.round(o.percentage),"Benar (PG)":o.correct_answers,"Salah (PG)":o.wrong_answers,"Tidak Dijawab":o.unanswered,Keterangan:o.percentage>=((x==null?void 0:x.passing_score)||75)?"Lulus":"Tidak Lulus"}}),c=te.json_to_sheet(s),a=te.book_new();te.book_append_sheet(a,c,"Hasil Ujian"),c["!cols"]=[{wch:5},{wch:15},{wch:25},{wch:15},{wch:20},{wch:12},{wch:12},{wch:8},{wch:8},{wch:15},{wch:15},{wch:20},{wch:20},{wch:15}];const h=`Hasil_${x==null?void 0:x.title.replace(/\s+/g,"_")}_${new Date().toISOString().split("T")[0]}.xlsx`;ts(a,h),l({title:"Success",description:"Data hasil ujian berhasil diekspor"})};return m?e.jsx("div",{className:"flex items-center justify-center min-h-screen p-4",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-10 w-10 sm:h-12 sm:w-12 border-b-2 border-blue-600 mx-auto"}),e.jsx("p",{className:"mt-4 text-sm sm:text-base text-gray-600",children:"Loading..."})]})}):x?e.jsxs("div",{className:"container mx-auto p-2 sm:p-4 md:p-6 space-y-4 sm:space-y-6",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-3 sm:gap-4",children:[e.jsxs("div",{className:"flex items-center gap-2 sm:gap-4",children:[e.jsxs(C,{className:"bg-blue-300 dark:bg-blue-800 hover:bg-blue-600 dark:hover:bg-blue-700",variant:"ghost",size:"sm",onClick:()=>i("/tests"),children:[e.jsx(ns,{className:"w-4 h-4 sm:mr-2"}),e.jsx("span",{className:"hidden sm:inline",children:"Kembali"})]}),e.jsx("div",{className:"flex-1 min-w-0",children:e.jsx("h1",{className:"text-xl sm:text-2xl md:text-3xl font-bold truncate",children:x.title})})]}),e.jsxs(C,{onClick:Ge,size:"sm",className:"w-full sm:w-auto",children:[e.jsx(ls,{className:"w-4 h-4 mr-2"}),e.jsx("span",{className:"hidden sm:inline",children:"Export Excel"}),e.jsx("span",{className:"sm:hidden",children:"Export"})]})]}),b&&e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4"}),b&&e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 gap-3 sm:gap-4",children:[e.jsx(S,{children:e.jsx(k,{className:"pt-4 sm:pt-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs sm:text-sm text-gray-500",children:"Rata-rata Nilai"}),e.jsx("p",{className:"text-xl sm:text-2xl font-bold",children:Math.round(b.average_score)})]}),e.jsx(fe,{className:"w-6 h-6 sm:w-8 sm:h-8 text-green-500 flex-shrink-0"})]})})}),e.jsx(S,{children:e.jsx(k,{className:"pt-4 sm:pt-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs sm:text-sm text-gray-500",children:"Nilai Tertinggi"}),e.jsx("p",{className:"text-xl sm:text-2xl font-bold text-green-600",children:Math.round(b.highest_score)})]}),e.jsx(fe,{className:"w-5 h-5 sm:w-6 sm:h-6 text-green-500 flex-shrink-0"})]})})}),e.jsx(S,{className:"sm:col-span-2 md:col-span-1",children:e.jsx(k,{className:"pt-4 sm:pt-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs sm:text-sm text-gray-500",children:"Nilai Terendah"}),e.jsx("p",{className:"text-xl sm:text-2xl font-bold text-red-600",children:Math.round(b.lowest_score)})]}),e.jsx(cs,{className:"w-5 h-5 sm:w-6 sm:h-6 text-red-500 flex-shrink-0"})]})})})]}),e.jsx(S,{children:e.jsx(k,{className:"pt-4 sm:pt-6",children:e.jsxs("div",{className:"flex flex-col md:flex-row gap-3 sm:gap-4",children:[e.jsxs("div",{className:"flex-1 relative",children:[e.jsx(is,{className:"absolute left-3 top-2.5 sm:top-3 h-4 w-4 text-gray-400"}),e.jsx(Ae,{placeholder:"Cari nama atau NIS siswa...",value:B,onChange:s=>O(s.target.value),className:"pl-10 text-sm sm:text-base"})]}),e.jsxs(Ye,{value:D,onValueChange:I,children:[e.jsx(Qe,{className:"w-full md:w-48 text-sm sm:text-base",children:e.jsx(Ze,{placeholder:"Filter Status"})}),e.jsxs(es,{children:[e.jsx(V,{value:"all",children:"Semua Status"}),e.jsx(V,{value:"completed",children:"Selesai"}),e.jsx(V,{value:"in_progress",children:"Sedang Mengerjakan"}),e.jsx(V,{value:"blocked",children:"Diblokir"})]})]})]})})}),e.jsxs(S,{className:"hidden md:block",children:[e.jsx(je,{children:e.jsxs(be,{children:["Daftar Hasil Ujian (",M.length,")"]})}),e.jsx(k,{children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs(We,{children:[e.jsx(Oe,{children:e.jsxs(ae,{children:[e.jsx(A,{children:"No"}),e.jsx(A,{children:"NIS"}),e.jsx(A,{children:"Nama Siswa"}),e.jsx(A,{children:"Kelas"}),e.jsx(A,{children:"Status"}),e.jsx(A,{children:"Skor"}),e.jsx(A,{children:"Benar/Salah (PG)"}),e.jsx(A,{children:"Keterangan"}),e.jsx(A,{className:"text-center",children:"Aksi"})]})}),e.jsx(Xe,{children:M.length===0?e.jsx(ae,{children:e.jsx(y,{colSpan:10,className:"text-center text-gray-500 py-8",children:"Tidak ada data hasil ujian"})}):M.map((s,c)=>{var a;return e.jsxs(ae,{children:[e.jsx(y,{children:c+1}),e.jsx(y,{children:s.student.nis}),e.jsx(y,{className:"font-medium",children:s.student.name}),e.jsx(y,{children:((a=s.student.class)==null?void 0:a.name)||"-"}),e.jsx(y,{children:le(s.status)}),e.jsx(y,{children:e.jsx("div",{className:"font-semibold text-md",children:Math.round(s.percentage)})}),e.jsxs(y,{children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-green-600 font-medium",children:s.correct_answers}),e.jsx("span",{className:"text-gray-400",children:"/"}),e.jsx("span",{className:"text-red-600 font-medium",children:s.wrong_answers})]}),e.jsx("div",{className:"text-xs text-gray-500 mt-1",children:"Pilihan Ganda"})]}),e.jsx(y,{children:s.status==="completed"&&ie(s.percentage,x.passing_score)}),e.jsx(y,{children:e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(C,{variant:"outline",size:"sm",onClick:()=>ce(s),children:[e.jsx(we,{className:"w-4 h-4 mr-1"}),"Detail"]}),s.status==="completed"&&e.jsxs(C,{variant:"outline",size:"sm",onClick:()=>de(s),children:[e.jsx(ye,{className:"w-4 h-4 mr-1"}),"Essay"]})]})})]},s.id)})})]})})})]}),e.jsxs("div",{className:"md:hidden space-y-3",children:[e.jsx("div",{className:"flex items-center justify-between mb-2",children:e.jsxs("h2",{className:"text-lg font-semibold",children:["Daftar Hasil Ujian (",M.length,")"]})}),M.length===0?e.jsx(S,{children:e.jsx(k,{className:"text-center text-gray-500 py-8",children:"Tidak ada data hasil ujian"})}):M.map((s,c)=>{var a;return e.jsx(S,{className:"border-0 shadow-sm",children:e.jsxs(k,{className:"p-4 space-y-3",children:[e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("span",{className:"text-sm font-medium text-gray-500",children:["#",c+1]}),le(s.status)]}),s.status==="completed"&&ie(s.percentage,x.passing_score)]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-gray-500",children:"Nama Siswa"}),e.jsx("p",{className:"font-semibold text-sm",children:s.student.name})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-gray-500",children:"NIS"}),e.jsx("p",{className:"text-sm font-medium",children:s.student.nis})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-gray-500",children:"Kelas"}),e.jsx("p",{className:"text-sm font-medium",children:((a=s.student.class)==null?void 0:a.name)||"-"})]})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3 pt-2 border-t",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-gray-500",children:"Skor"}),e.jsx("p",{className:"text-lg font-bold text-blue-600",children:Math.round(s.percentage)})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-gray-500",children:"Benar/Salah (PG)"}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("span",{className:"text-green-600 font-semibold text-sm",children:s.correct_answers}),e.jsx("span",{className:"text-gray-400",children:"/"}),e.jsx("span",{className:"text-red-600 font-semibold text-sm",children:s.wrong_answers})]})]})]}),e.jsxs("div",{className:"flex gap-2 pt-2 border-t",children:[e.jsxs(C,{variant:"outline",size:"sm",className:"flex-1",onClick:()=>ce(s),children:[e.jsx(we,{className:"w-4 h-4 mr-1"}),"Detail"]}),s.status==="completed"&&e.jsxs(C,{variant:"outline",size:"sm",className:"flex-1",onClick:()=>de(s),children:[e.jsx(ye,{className:"w-4 h-4 mr-1"}),"Essay"]})]})]})},s.id)})]}),e.jsx(Ce,{open:Y,onOpenChange:R,children:e.jsxs(Te,{className:"max-w-4xl max-h-[90vh] sm:max-h-[80vh] overflow-y-auto p-4 sm:p-6",children:[e.jsxs(Ee,{children:[e.jsx(De,{className:"text-lg sm:text-xl",children:"Detail Hasil Ujian"}),e.jsx(as,{className:"text-sm",children:"Rincian jawaban dan penilaian siswa"})]}),p&&e.jsxs("div",{className:"space-y-3 sm:space-y-4",children:[e.jsx(S,{children:e.jsx(k,{className:"pt-4 sm:pt-6",children:e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3 sm:gap-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs sm:text-sm text-gray-500",children:"Nama Siswa"}),e.jsx("p",{className:"font-semibold text-sm sm:text-base",children:p.student.name})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs sm:text-sm text-gray-500",children:"NIS"}),e.jsx("p",{className:"font-semibold text-sm sm:text-base",children:p.student.nis})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs sm:text-sm text-gray-500",children:"Skor"}),e.jsxs("p",{className:"text-xl sm:text-2xl font-bold text-blue-600",children:[p.score,"/",p.max_score]}),e.jsxs("p",{className:"text-xs sm:text-sm text-gray-500 mt-1",children:["(",Math.round(p.percentage),")"]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs sm:text-sm text-gray-500",children:"Jawaban Benar"}),e.jsx("p",{className:"font-semibold text-sm sm:text-base text-green-600",children:p.correct_answers})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs sm:text-sm text-gray-500",children:"Jawaban Salah"}),e.jsx("p",{className:"font-semibold text-sm sm:text-base text-red-600",children:p.wrong_answers})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs sm:text-sm text-gray-500",children:"Tidak Dijawab"}),e.jsx("p",{className:"font-semibold text-sm sm:text-base text-gray-600",children:p.unanswered})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs sm:text-sm text-gray-500",children:"Durasi"}),e.jsxs("p",{className:"font-semibold text-sm sm:text-base",children:[p.duration_minutes," menit"]})]})]})})}),p.answers&&p.answers.length>0&&e.jsxs(S,{children:[e.jsx(je,{className:"p-4 sm:p-6",children:e.jsx(be,{className:"text-base sm:text-lg",children:"Jawaban Per Soal"})}),e.jsx(k,{className:"space-y-3 sm:space-y-4 p-4 sm:p-6 pt-0",children:p.answers.map((s,c)=>{var a,h,o,d,n,w,H,K,oe,xe,me,he;return e.jsxs("div",{className:`border rounded-lg p-3 sm:p-4 ${s.is_correct?"border-green-200 bg-green-50 dark:border-green-800 dark:bg-green-950":((a=s.question)==null?void 0:a.question_type)==="essay"?"border-blue-200 bg-blue-50 dark:border-blue-800 dark:bg-blue-950":"border-red-200 bg-red-50 dark:border-red-800 dark:bg-red-950"}`,children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-start sm:justify-between gap-2 mb-3",children:[e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsxs(j,{variant:"outline",className:"text-xs",children:["Soal ",c+1]}),e.jsx(j,{variant:"secondary",className:"text-xs",children:((h=s.question)==null?void 0:h.question_type)==="multiple_choice"?"Pilihan Ganda":"Essay"}),e.jsxs(j,{variant:"secondary",className:"text-xs",children:[((o=s.question)==null?void 0:o.points)||0," poin"]})]}),((d=s.question)==null?void 0:d.question_type)==="multiple_choice"&&e.jsx("div",{className:"flex items-center gap-2",children:s.is_correct?e.jsxs(j,{className:"bg-green-500 text-xs",children:[e.jsx(rs,{className:"w-3 h-3 mr-1"}),"Benar"]}):e.jsxs(j,{className:"bg-red-500 text-xs",children:[e.jsx(qe,{className:"w-3 h-3 mr-1"}),"Salah"]})}),((n=s.question)==null?void 0:n.question_type)==="essay"&&e.jsxs(j,{className:"bg-blue-500 text-xs",children:[s.points_earned||0,"/",((w=s.question)==null?void 0:w.points)||0," poin"]})]}),e.jsxs("div",{className:"mb-3",children:[e.jsx("p",{className:"text-xs sm:text-sm font-semibold text-gray-700 dark:text-gray-300 mb-2",children:"Pertanyaan:"}),e.jsx("div",{className:"text-xs sm:text-sm",children:e.jsx(W,{content:((H=s.question)==null?void 0:H.question_text)||""})})]}),((K=s.question)==null?void 0:K.question_type)==="multiple_choice"&&e.jsxs("div",{className:"space-y-2",children:[e.jsx("p",{className:"text-xs sm:text-sm font-semibold text-gray-700 dark:text-gray-300",children:"Pilihan Jawaban:"}),(xe=(oe=s.question)==null?void 0:oe.options)==null?void 0:xe.map(z=>{const Q=z.id===s.option_id,Z=z.is_correct;return e.jsxs("div",{className:`p-2 sm:p-3 rounded border ${Q&&Z?"bg-green-100 border-green-300 dark:bg-green-900 dark:border-green-700":Q?"bg-red-100 border-red-300 dark:bg-red-900 dark:border-red-700":Z?"bg-green-50 border-green-200 dark:bg-green-950 dark:border-green-800":"bg-white border-gray-200 dark:bg-gray-800 dark:border-gray-700"}`,children:[e.jsxs("div",{className:"flex flex-wrap items-center gap-2 mb-1",children:[Q&&e.jsx(j,{variant:"outline",className:"text-xs",children:"Jawaban Siswa"}),Z&&e.jsx(j,{variant:"outline",className:"bg-green-50 dark:bg-green-900 text-xs",children:"✓ Jawaban Benar"})]}),e.jsx("div",{className:"text-xs sm:text-sm",children:e.jsx(W,{content:z.option_text})})]},z.id)})]}),((me=s.question)==null?void 0:me.question_type)==="essay"&&e.jsxs("div",{className:"space-y-2",children:[((he=s.question)==null?void 0:he.expected_answer)&&e.jsxs("div",{className:"bg-green-50 border border-green-200 dark:bg-green-950 dark:border-green-800 p-2 sm:p-3 rounded",children:[e.jsx("p",{className:"text-xs sm:text-sm font-semibold text-green-700 dark:text-green-300 mb-1",children:"Jawaban yang Diharapkan:"}),e.jsx("p",{className:"text-xs sm:text-sm text-green-900 dark:text-green-100 whitespace-pre-wrap break-words",children:s.question.expected_answer})]}),e.jsxs("div",{className:"bg-blue-50 border border-blue-200 dark:bg-blue-950 dark:border-blue-800 p-2 sm:p-3 rounded",children:[e.jsx("p",{className:"text-xs sm:text-sm font-semibold text-blue-700 dark:text-blue-300 mb-1",children:"Jawaban Siswa:"}),e.jsx("p",{className:"text-xs sm:text-sm text-blue-900 dark:text-blue-100 whitespace-pre-wrap break-words",children:s.answer_text||e.jsx("span",{className:"italic text-gray-500 dark:text-gray-400",children:"Tidak dijawab"})})]})]})]},s.id)})})]})]})]})}),t&&u&&e.jsx(ds,{isOpen:r,onClose:()=>N(!1),testId:t,attemptId:u,studentName:F,onGradeSubmitted:Pe})]}):e.jsx("div",{className:"flex items-center justify-center min-h-screen p-4",children:e.jsx("div",{className:"text-center",children:e.jsx("p",{className:"text-sm sm:text-base text-gray-600",children:"Test not found"})})})}export{Ms as default};
