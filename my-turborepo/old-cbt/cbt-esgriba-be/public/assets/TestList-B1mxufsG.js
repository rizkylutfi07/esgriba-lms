var je=Object.defineProperty,pe=Object.defineProperties;var ge=Object.getOwnPropertyDescriptors;var F=Object.getOwnPropertySymbols;var fe=Object.prototype.hasOwnProperty,be=Object.prototype.propertyIsEnumerable;var z=(a,i,t)=>i in a?je(a,i,{enumerable:!0,configurable:!0,writable:!0,value:t}):a[i]=t,u=(a,i)=>{for(var t in i||(i={}))fe.call(i,t)&&z(a,t,i[t]);if(F)for(var t of F(i))be.call(i,t)&&z(a,t,i[t]);return a},k=(a,i)=>pe(a,ge(i));var w=(a,i,t)=>new Promise((m,b)=>{var j=l=>{try{N(t.next(l))}catch(x){b(x)}},U=l=>{try{N(t.throw(l))}catch(x){b(x)}},N=l=>l.done?m(l.value):Promise.resolve(l.value).then(j,U);N((t=t.apply(a,i)).next())});import{j as e}from"./vendor-ui-XVksrZ5j.js";import{u as Ne,r as y}from"./vendor-react-DruPVAFJ.js";import{f as oe,u as ve,h as ke,e as we,B as C,C as T,d as _,L as I,I as ye}from"./index-BmVdEGiP.js";import{S as G,a as V,b as R,c as q,d as f}from"./select-CT0oUeJ5.js";import{T as Ce,a as De,b as K,c as D,d as Se,e as S}from"./table-BTQg55BV.js";import{D as O,a as X,b as J,c as r,e as A}from"./dropdown-menu-BDf3JuuU.js";import{t as M}from"./testService-BhFWneWt.js";import{A as Te,a as _e,b as Ae,c as Me,d as Pe,e as Ue,f as Ee,g as Ie}from"./alert-dialog-DeGwCm2P.js";import{P as W}from"./plus-BcW2gs2h.js";import{S as Le}from"./search-NdQjMSfE.js";import{B as P}from"./book-open-CXdsRrc-.js";import{S as Y}from"./shield-kQPazkiq.js";import{U as Q}from"./users-Cv97A8df.js";import{C as Z}from"./calendar-CL5fPy6R.js";import{C as L}from"./clock-eO0sA20s.js";import{M as ee}from"./more-vertical-BMsgZsCU.js";import{E as se}from"./eye-ErUhf9Bf.js";import{A as ae}from"./activity-BvSUlSke.js";import{P as ie}from"./pen-square-DdkHHRrl.js";import{C as te}from"./copy-pRjNeCAu.js";import{X as le}from"./x-circle-Czjy44Dj.js";import{T as re}from"./trash-2-SALYx2gF.js";import{P as ne}from"./play-circle-DOrl6LA7.js";import"./vendor-utils-DI_-nBMo.js";import"./vendor-charts-BB9d_U7u.js";import"./chevron-down-CL3T_hsi.js";import"./check-BFyP0Qeo.js";import"./chevron-right-DGvanUYx.js";import"./circle-B_uur8fk.js";/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const de=oe("ClipboardCheck",[["rect",{width:"8",height:"4",x:"8",y:"2",rx:"1",ry:"1",key:"tgr4d6"}],["path",{d:"M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2",key:"116196"}],["path",{d:"m9 14 2 2 4-4",key:"df797q"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ce=oe("Globe",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 2a14.5 14.5 0 0 0 0 20 14.5 14.5 0 0 0 0-20",key:"13o1zl"}],["path",{d:"M2 12h20",key:"9i4pu4"}]]);function hs(){const a=Ne(),{toast:i}=ve(),{user:t}=ke(),m=(t==null?void 0:t.role)==="guru"||(t==null?void 0:t.role)==="admin",[b,j]=y.useState([]),[U,N]=y.useState(!0),[l,x]=y.useState(null),[me,xe]=y.useState([]),[h,E]=y.useState({per_page:20,page:1});y.useEffect(()=>{$(),he()},[h]);const $=(s=!1)=>w(this,null,function*(){var n,c;try{s||N(!0);const d=yield M.getTests(h);j(d.data||d)}catch(d){i({title:"Error",description:((c=(n=d.response)==null?void 0:n.data)==null?void 0:c.message)||"Gagal memuat daftar ujian",variant:"destructive"})}finally{N(!1)}}),he=()=>w(this,null,function*(){try{const s=yield we.get("/subjects");xe(s.data.data||[])}catch(s){console.error("Error loading subjects:",s)}}),ue=()=>w(this,null,function*(){var s,n;if(l)try{yield M.deleteTest(l.id),i({title:"Sukses",description:"Ujian berhasil dihapus"}),x(null),$()}catch(c){i({title:"Error",description:((n=(s=c.response)==null?void 0:s.data)==null?void 0:n.message)||"Gagal menghapus ujian",variant:"destructive"})}}),B=s=>w(this,null,function*(){var n,c;try{const d=yield M.duplicateTest(s.id),v=d.data||d;v&&v.id&&j(o=>[v,...o]),i({title:"Sukses",description:"Ujian berhasil diduplikasi"})}catch(d){i({title:"Error",description:((c=(n=d.response)==null?void 0:n.data)==null?void 0:c.message)||"Gagal menduplikasi ujian",variant:"destructive"})}}),H=s=>w(this,null,function*(){var d,v;const n=new Date(s.end_time)<new Date;if(!s.is_active&&n){i({title:"Tidak Bisa Publikasi",description:"Ujian sudah berakhir. Silakan perbarui waktu ujian terlebih dahulu.",variant:"destructive"});return}const c=!s.is_active;j(o=>o.map(p=>p.id===s.id?k(u({},p),{is_active:c}):p));try{const o=yield M.togglePublish(s.id);o!=null&&o.data&&j(p=>p.map(g=>g.id===s.id?u(u({},g),o.data):g)),i({title:"Sukses",description:c?"Ujian berhasil dipublikasikan":"Ujian berhasil di-nonaktifkan"})}catch(o){j(p=>p.map(g=>g.id===s.id?k(u({},g),{is_active:s.is_active}):g)),i({title:"Error",description:((v=(d=o.response)==null?void 0:d.data)==null?void 0:v.message)||"Gagal mengubah status ujian",variant:"destructive"})}});return e.jsxs("div",{className:"p-2 sm:p-3 space-y-6 overflow-x-hidden",children:[e.jsxs("div",{className:"flex flex-col gap-2 sm:flex-row sm:justify-between sm:items-center",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold",children:"Daftar Ujian"}),e.jsx("p",{className:"text-muted-foreground mt-1",children:m?"Kelola ujian Anda":"Ujian yang tersedia untuk Anda"})]}),m&&e.jsxs(C,{onClick:()=>a("/tests/create"),children:[e.jsx(W,{className:"w-4 h-4 mr-2"}),"Buat Ujian"]})]}),e.jsx(T,{children:e.jsx(_,{className:"pt-6",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx(I,{children:"Cari Ujian"}),e.jsxs("div",{className:"relative",children:[e.jsx(Le,{className:"absolute left-2 top-2.5 h-4 w-4 text-muted-foreground"}),e.jsx(ye,{placeholder:"Cari judul atau deskripsi...",className:"pl-8",value:h.search||"",onChange:s=>E(k(u({},h),{search:s.target.value,page:1}))})]})]}),e.jsxs("div",{children:[e.jsx(I,{children:"Mata Pelajaran"}),e.jsxs(G,{value:h.subject||"all",onValueChange:s=>E(k(u({},h),{subject:s==="all"?void 0:s,page:1})),children:[e.jsx(V,{children:e.jsx(R,{placeholder:"Semua Mata Pelajaran"})}),e.jsxs(q,{children:[e.jsx(f,{value:"all",children:"Semua Mata Pelajaran"}),me.map(s=>e.jsx(f,{value:s.name,children:s.name},s.id))]})]})]}),e.jsxs("div",{children:[e.jsx(I,{children:"Status"}),e.jsxs(G,{value:h.status||"all",onValueChange:s=>E(k(u({},h),{status:s==="all"?void 0:s,page:1})),children:[e.jsx(V,{children:e.jsx(R,{placeholder:"Semua"})}),e.jsxs(q,{children:[e.jsx(f,{value:"all",children:"Semua"}),e.jsx(f,{value:"active",children:"Aktif"}),e.jsx(f,{value:"upcoming",children:"Akan Datang"}),e.jsx(f,{value:"finished",children:"Selesai"}),m&&e.jsx(f,{value:"draft",children:"Draft"})]})]})]})]})})}),U?e.jsx("div",{className:"flex justify-center py-16",children:e.jsxs("div",{className:"text-center space-y-4",children:[e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"animate-spin rounded-full h-16 w-16 border-b-4 border-t-4 border-blue-600 mx-auto"}),e.jsx("div",{className:"absolute inset-0 rounded-full h-16 w-16 border-4 border-blue-100 mx-auto"})]}),e.jsx("p",{className:"text-lg font-medium text-muted-foreground animate-pulse",children:"Memuat daftar ujian..."})]})}):b.length===0?e.jsx(T,{className:"border-0 shadow-sm",children:e.jsxs(_,{className:"text-center py-16",children:[e.jsx("div",{className:"inline-flex p-6 bg-muted rounded-full mb-4",children:e.jsx(P,{className:"w-16 h-16 text-muted-foreground"})}),e.jsx("h3",{className:"text-xl font-semibold mb-2",children:"Tidak ada ujian ditemukan"}),e.jsx("p",{className:"text-muted-foreground mb-6",children:"Belum ada ujian yang tersedia saat ini"}),m&&e.jsxs(C,{size:"lg",className:"gap-2 bg-gradient-to-r from-blue-600 to-indigo-600 hover:from-blue-700 hover:to-indigo-700",onClick:()=>a("/tests/create"),children:[e.jsx(W,{className:"w-5 h-5"}),"Buat Ujian Pertama"]})]})}):e.jsxs(e.Fragment,{children:[e.jsx(T,{className:"border-0 shadow-md hidden md:block",children:e.jsx(_,{className:"p-0",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs(Ce,{children:[e.jsx(De,{children:e.jsxs(K,{className:"bg-muted/50 hover:bg-muted rounded-lg",children:[e.jsx(D,{className:"font-bold",children:"Judul Ujian"}),e.jsx(D,{className:"font-bold",children:"Mapel & Kelas"}),e.jsx(D,{className:"font-bold",children:"Tanggal & Waktu"}),e.jsx(D,{className:"font-bold text-center",children:"Status"}),e.jsx(D,{className:"font-bold text-right",children:"Aksi"})]})}),e.jsx(Se,{children:b.map((s,n)=>e.jsxs(K,{className:`hover:bg-muted/30 transition-colors ${n%2===0?"":"bg-muted/10"}`,children:[e.jsx(S,{className:"font-medium",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-blue-500/10 dark:bg-blue-500/20 rounded-lg",children:e.jsx(P,{className:"w-4 h-4 text-blue-600 dark:text-blue-400"})}),e.jsxs("div",{children:[e.jsx("div",{className:"font-semibold line-clamp-1",children:s.title}),Number(s.allowed_students_count||0)>0&&e.jsxs("span",{className:"inline-flex items-center gap-1 mt-1 px-2 py-0.5 rounded text-xs font-medium bg-blue-500/10 text-blue-700 dark:bg-blue-500/20 dark:text-blue-400",children:[e.jsx(Y,{className:"w-3 h-3"})," Remidi"]})]})]})}),e.jsx(S,{children:e.jsxs("div",{className:"space-y-1",children:[e.jsxs("div",{className:"flex items-center gap-1.5 text-sm font-medium text-blue-700 dark:text-blue-400",children:[e.jsx(P,{className:"w-3.5 h-3.5"}),s.subject]}),e.jsxs("div",{className:"flex items-center gap-1.5 text-sm text-purple-700 dark:text-purple-400",children:[e.jsx(Q,{className:"w-3.5 h-3.5"}),s.kelas]})]})}),e.jsx(S,{children:e.jsxs("div",{className:"space-y-1",children:[e.jsxs("div",{className:"flex items-center gap-1.5 text-sm font-medium",children:[e.jsx(Z,{className:"w-3.5 h-3.5 text-amber-600 dark:text-amber-400"}),e.jsx("span",{children:new Date(s.start_time).toLocaleDateString("id-ID",{day:"numeric",month:"short",year:"numeric"})})]}),e.jsxs("div",{className:"flex items-center gap-1.5 text-xs text-muted-foreground",children:[e.jsx(L,{className:"w-3 h-3 text-green-600 dark:text-green-400"}),new Date(s.start_time).toLocaleTimeString("id-ID",{hour:"2-digit",minute:"2-digit"})," ","-"," ",new Date(s.end_time).toLocaleTimeString("id-ID",{hour:"2-digit",minute:"2-digit"})]})]})}),e.jsx(S,{className:"text-center",children:e.jsx("span",{className:`inline-flex items-center px-3 py-1 rounded-full text-xs font-bold ${s.is_active?"bg-gradient-to-r from-green-500 to-emerald-500 text-white":"bg-gradient-to-r from-gray-400 to-gray-500 text-white"}`,children:s.is_active?"✓ Aktif":"○ Draft"})}),e.jsx(S,{className:"text-right",children:m?e.jsxs(O,{children:[e.jsx(X,{asChild:!0,children:e.jsx(C,{variant:"ghost",size:"sm",className:"h-8 w-8 p-0",children:e.jsx(ee,{className:"h-4 w-4"})})}),e.jsxs(J,{align:"end",className:"w-48",children:[e.jsxs(r,{onClick:()=>a(`/tests/${s.id}`),children:[e.jsx(se,{className:"w-4 h-4 mr-2"}),"Detail"]}),e.jsxs(r,{onClick:()=>a(`/tests/${s.id}/results`),children:[e.jsx(de,{className:"w-4 h-4 mr-2"}),"Penilaian"]}),e.jsxs(r,{onClick:()=>a("/monitoring"),children:[e.jsx(ae,{className:"w-4 h-4 mr-2"}),"Monitoring"]}),e.jsx(A,{}),e.jsxs(r,{onClick:()=>a(`/tests/${s.id}/edit`),children:[e.jsx(ie,{className:"w-4 h-4 mr-2"}),"Edit"]}),e.jsxs(r,{onClick:()=>B(s),children:[e.jsx(te,{className:"w-4 h-4 mr-2"}),"Duplikat"]}),e.jsx(A,{}),e.jsx(r,{onClick:()=>H(s),disabled:!s.is_active&&new Date(s.end_time)<new Date,className:s.is_active?"text-red-600 focus:text-red-600":"text-green-600 focus:text-green-600",children:s.is_active?e.jsxs(e.Fragment,{children:[e.jsx(le,{className:"w-4 h-4 mr-2"}),"Nonaktifkan"]}):e.jsxs(e.Fragment,{children:[e.jsx(ce,{className:"w-4 h-4 mr-2"}),"Publikasi"]})}),e.jsxs(r,{onClick:()=>x(s),className:"text-red-600",children:[e.jsx(re,{className:"w-4 h-4 mr-2"}),"Hapus"]})]})]}):e.jsxs(C,{onClick:()=>a(`/tests/${s.id}`),size:"sm",className:"gap-2 bg-gradient-to-r from-blue-600 to-indigo-600 hover:from-blue-700 hover:to-indigo-700",children:[e.jsx(ne,{className:"w-4 h-4"}),"Mulai Ujian"]})})]},s.id))})]})})})}),e.jsx("div",{className:"space-y-3 md:hidden",children:b.map(s=>e.jsx(T,{className:"border-0 shadow-sm hover:shadow-md transition-all",children:e.jsx(_,{className:"p-4",children:e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-start justify-between gap-2",children:[e.jsx("div",{className:"flex-1 min-w-0",children:e.jsx("h3",{className:"font-bold text-sm line-clamp-2",children:s.title})}),e.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-bold flex-shrink-0 ${s.is_active?"bg-green-500 text-white":"bg-gray-400 text-white"}`,children:s.is_active?"Aktif":"Draft"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-2 text-xs",children:[e.jsxs("div",{className:"flex items-center gap-1.5 text-blue-700 dark:text-blue-400",children:[e.jsx(P,{className:"w-3.5 h-3.5 flex-shrink-0"}),e.jsx("span",{className:"truncate",children:s.subject})]}),e.jsxs("div",{className:"flex items-center gap-1.5 text-purple-700 dark:text-purple-400",children:[e.jsx(Q,{className:"w-3.5 h-3.5 flex-shrink-0"}),e.jsx("span",{className:"truncate",children:s.kelas})]}),e.jsxs("div",{className:"flex items-center gap-1.5 col-span-2",children:[e.jsx(Z,{className:"w-3.5 h-3.5 flex-shrink-0 text-amber-600 dark:text-amber-400"}),e.jsx("span",{children:new Date(s.start_time).toLocaleDateString("id-ID",{day:"numeric",month:"short",year:"numeric"})})]}),e.jsxs("div",{className:"flex items-center gap-1.5 text-green-700 dark:text-green-400",children:[e.jsx(L,{className:"w-3.5 h-3.5 flex-shrink-0"}),new Date(s.start_time).toLocaleTimeString("id-ID",{hour:"2-digit",minute:"2-digit"})]}),e.jsxs("div",{className:"flex items-center gap-1.5 text-red-700 dark:text-red-400",children:[e.jsx(L,{className:"w-3.5 h-3.5 flex-shrink-0"}),new Date(s.end_time).toLocaleTimeString("id-ID",{hour:"2-digit",minute:"2-digit"})]})]}),Number(s.allowed_students_count||0)>0&&e.jsxs("div",{className:"flex items-center gap-1 px-2 py-1 rounded bg-blue-500/10 text-blue-700 dark:bg-blue-500/20 dark:text-blue-400 text-xs font-medium w-fit",children:[e.jsx(Y,{className:"w-3 h-3"})," Remidi"]}),e.jsx("div",{className:"flex gap-2 pt-2 border-t",children:m?e.jsxs(O,{children:[e.jsx(X,{asChild:!0,children:e.jsxs(C,{variant:"outline",size:"sm",className:"w-full",children:[e.jsx(ee,{className:"w-4 h-4 mr-2"}),"Menu"]})}),e.jsxs(J,{align:"end",className:"w-48",children:[e.jsxs(r,{onClick:()=>a(`/tests/${s.id}`),children:[e.jsx(se,{className:"w-4 h-4 mr-2"}),"Detail"]}),e.jsxs(r,{onClick:()=>a(`/tests/${s.id}/results`),children:[e.jsx(de,{className:"w-4 h-4 mr-2"}),"Penilaian"]}),e.jsxs(r,{onClick:()=>a("/monitoring/"),children:[e.jsx(ae,{className:"w-4 h-4 mr-2"}),"Monitoring"]}),e.jsx(A,{}),e.jsxs(r,{onClick:()=>a(`/tests/${s.id}/edit`),children:[e.jsx(ie,{className:"w-4 h-4 mr-2"}),"Edit"]}),e.jsxs(r,{onClick:()=>B(s),children:[e.jsx(te,{className:"w-4 h-4 mr-2"}),"Duplikat"]}),e.jsx(A,{}),e.jsx(r,{onClick:()=>H(s),disabled:!s.is_active&&new Date(s.end_time)<new Date,className:s.is_active?"text-red-600 focus:text-red-600":"text-green-600 focus:text-green-600",children:s.is_active?e.jsxs(e.Fragment,{children:[e.jsx(le,{className:"w-4 h-4 mr-2"}),"Nonaktifkan"]}):e.jsxs(e.Fragment,{children:[e.jsx(ce,{className:"w-4 h-4 mr-2"}),"Publikasi"]})}),e.jsxs(r,{onClick:()=>x(s),className:"text-red-600",children:[e.jsx(re,{className:"w-4 h-4 mr-2"}),"Hapus"]})]})]}):e.jsxs(C,{onClick:()=>a(`/tests/${s.id}`),size:"sm",className:"w-full gap-2 bg-gradient-to-r from-blue-600 to-indigo-600",children:[e.jsx(ne,{className:"w-4 h-4"}),"Mulai Ujian"]})})]})})},s.id))})]}),e.jsx(Te,{open:!!l,onOpenChange:()=>x(null),children:e.jsxs(_e,{children:[e.jsxs(Ae,{children:[e.jsx(Me,{children:"Hapus Ujian?"}),e.jsxs(Pe,{children:['Ujian yang dihapus tidak dapat dikembalikan. Semua data soal dan hasil ujian akan hilang. Yakin ingin menghapus ujian "',l==null?void 0:l.title,'"?']})]}),e.jsxs(Ue,{children:[e.jsx(Ee,{children:"Batal"}),e.jsx(Ie,{onClick:ue,children:"Hapus"})]})]})})]})}export{hs as default};
