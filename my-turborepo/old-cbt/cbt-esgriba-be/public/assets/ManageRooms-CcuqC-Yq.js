var G=Object.defineProperty,M=Object.defineProperties;var $=Object.getOwnPropertyDescriptors;var T=Object.getOwnPropertySymbols;var z=Object.prototype.hasOwnProperty,q=Object.prototype.propertyIsEnumerable;var E=(l,n,s)=>n in l?G(l,n,{enumerable:!0,configurable:!0,writable:!0,value:s}):l[n]=s,o=(l,n)=>{for(var s in n||(n={}))z.call(n,s)&&E(l,s,n[s]);if(T)for(var s of T(n))q.call(n,s)&&E(l,s,n[s]);return l},m=(l,n)=>M(l,$(n));var D=(l,n,s)=>new Promise((h,w)=>{var x=t=>{try{g(s.next(t))}catch(b){w(b)}},p=t=>{try{g(s.throw(t))}catch(b){w(b)}},g=t=>t.done?h(t.value):Promise.resolve(t.value).then(x,p);g((s=s.apply(l,n)).next())});import{j as a}from"./vendor-ui-XVksrZ5j.js";import{r as d}from"./vendor-react-DruPVAFJ.js";import{u as A,e as R,B as u,C as U,a as _,b as J,c as Q,d as V,L as v,I as N}from"./index-BmVdEGiP.js";import{D as O,b as B,c as F,d as I,e as L,f as H}from"./dialog-FHcYl0q1.js";import{P as W}from"./plus-BcW2gs2h.js";import{D as X}from"./door-open-BWKzwyqs.js";import{P as Y}from"./pen-square-DdkHHRrl.js";import{T as Z}from"./trash-2-SALYx2gF.js";import"./vendor-utils-DI_-nBMo.js";import"./vendor-charts-BB9d_U7u.js";function ma(){const[l,n]=d.useState([]),[s,h]=d.useState(!1),[w,x]=d.useState(!1),[p,g]=d.useState(null),[t,b]=d.useState(null),[y,C]=d.useState(!1),{toast:f}=A(),[i,c]=d.useState({code:"",name:"",capacity:"",building:"",floor:""});d.useEffect(()=>{k()},[]);const k=()=>D(this,null,function*(){try{const e=yield R.get("/rooms");n(e.data.data)}catch(e){f({title:"Error",description:"Gagal memuat data ruangan",variant:"destructive"})}}),S=e=>{var r;e?(g(e),c({code:e.code,name:e.name,capacity:e.capacity.toString(),building:e.building||"",floor:((r=e.floor)==null?void 0:r.toString())||""})):(g(null),c({code:"",name:"",capacity:"",building:"",floor:""})),h(!0)},K=()=>D(this,null,function*(){var e,r;C(!0);try{const j=m(o({},i),{building:i.building||null,floor:i.floor?parseInt(i.floor):null});p?(yield R.put(`/rooms/${p.id}`,j),f({title:"Berhasil",description:"Ruangan berhasil diperbarui"})):(yield R.post("/rooms",j),f({title:"Berhasil",description:"Ruangan berhasil ditambahkan"})),h(!1),k()}catch(j){f({title:"Error",description:((r=(e=j.response)==null?void 0:e.data)==null?void 0:r.message)||"Terjadi kesalahan",variant:"destructive"})}finally{C(!1)}}),P=()=>D(this,null,function*(){var e,r;if(t){C(!0);try{yield R.delete(`/rooms/${t}`),f({title:"Berhasil",description:"Ruangan berhasil dihapus"}),x(!1),k()}catch(j){f({title:"Error",description:((r=(e=j.response)==null?void 0:e.data)==null?void 0:r.message)||"Gagal menghapus ruangan",variant:"destructive"})}finally{C(!1)}}});return a.jsxs("div",{className:"p-3 sm:p-6 pb-20",children:[a.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-2 sm:gap-4 mb-4 sm:mb-6",children:[a.jsxs("div",{children:[a.jsx("h1",{className:"text-2xl sm:text-3xl font-bold",children:"Kelola Ruangan"}),a.jsx("p",{className:"text-muted-foreground mt-1 text-sm sm:text-base",children:"Manajemen data ruangan dan kapasitas"})]}),a.jsxs(u,{className:"h-9 sm:h-10",onClick:()=>S(),children:[a.jsx(W,{className:"mr-2 h-4 w-4"}),a.jsx("span",{className:"hidden sm:inline",children:"Tambah Ruangan"}),a.jsx("span",{className:"sm:hidden",children:"Tambah"})]})]}),a.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:l.map(e=>a.jsxs(U,{children:[a.jsxs(_,{children:[a.jsxs("div",{className:"flex items-start justify-between",children:[a.jsx(X,{className:"h-8 w-8 text-primary"}),a.jsx("span",{className:"text-xs bg-secondary px-2 py-1 rounded",children:e.code})]}),a.jsx(J,{className:"mt-2",children:e.name}),a.jsx(Q,{children:e.building&&e.floor?`${e.building} - Lantai ${e.floor}`:"Lokasi belum diatur"})]}),a.jsxs(V,{children:[a.jsxs("div",{className:"space-y-2 mb-4",children:[a.jsxs("div",{className:"flex items-center justify-between text-sm",children:[a.jsx("span",{className:"text-muted-foreground",children:"Kapasitas:"}),a.jsxs("span",{className:"font-medium",children:[e.capacity," orang"]})]}),a.jsxs("div",{className:"flex items-center justify-between text-sm",children:[a.jsx("span",{className:"text-muted-foreground",children:"Total Ujian:"}),a.jsx("span",{className:"font-medium",children:e.tests_count||0})]})]}),a.jsxs("div",{className:"flex gap-2",children:[a.jsxs(u,{variant:"outline",size:"sm",onClick:()=>S(e),className:"flex-1",children:[a.jsx(Y,{className:"mr-1 h-3 w-3"})," Edit"]}),a.jsxs(u,{variant:"destructive",size:"sm",onClick:()=>{b(e.id),x(!0)},className:"flex-1",children:[a.jsx(Z,{className:"mr-1 h-3 w-3"})," Hapus"]})]})]})]},e.id))}),a.jsx(O,{open:s,onOpenChange:h,children:a.jsxs(B,{className:"w-[95vw] sm:max-w-[500px]",children:[a.jsxs(F,{children:[a.jsx(I,{children:p?"Edit Ruangan":"Tambah Ruangan"}),a.jsx(L,{children:p?"Perbarui informasi ruangan":"Tambahkan ruangan baru"})]}),a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{children:[a.jsx(v,{htmlFor:"code",children:"Kode Ruangan"}),a.jsx(N,{id:"code",value:i.code,onChange:e=>c(m(o({},i),{code:e.target.value})),placeholder:"Contoh: R-101"})]}),a.jsxs("div",{children:[a.jsx(v,{htmlFor:"name",children:"Nama Ruangan"}),a.jsx(N,{id:"name",value:i.name,onChange:e=>c(m(o({},i),{name:e.target.value})),placeholder:"Contoh: Ruang Kelas 101"})]}),a.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx(v,{htmlFor:"capacity",children:"Kapasitas"}),a.jsx(N,{id:"capacity",type:"number",value:i.capacity,onChange:e=>c(m(o({},i),{capacity:e.target.value})),placeholder:"Contoh: 40"})]}),a.jsxs("div",{children:[a.jsx(v,{htmlFor:"floor",children:"Lantai"}),a.jsx(N,{id:"floor",type:"number",value:i.floor,onChange:e=>c(m(o({},i),{floor:e.target.value})),placeholder:"Contoh: 1"})]})]}),a.jsxs("div",{children:[a.jsx(v,{htmlFor:"building",children:"Gedung"}),a.jsx(N,{id:"building",value:i.building,onChange:e=>c(m(o({},i),{building:e.target.value})),placeholder:"Contoh: Gedung A"})]})]}),a.jsxs(H,{className:"flex flex-col sm:flex-row gap-2",children:[a.jsx(u,{variant:"outline",onClick:()=>h(!1),className:"w-full sm:w-auto",children:"Batal"}),a.jsx(u,{onClick:K,disabled:y,className:"w-full sm:w-auto",children:y?"Menyimpan...":"Simpan"})]})]})}),a.jsx(O,{open:w,onOpenChange:x,children:a.jsxs(B,{className:"w-[95vw] sm:max-w-[425px]",children:[a.jsxs(F,{children:[a.jsx(I,{children:"Hapus Ruangan?"}),a.jsx(L,{children:"Data ruangan akan dihapus permanen. Tindakan ini tidak dapat dibatalkan."})]}),a.jsxs(H,{className:"flex flex-col sm:flex-row gap-2",children:[a.jsx(u,{variant:"outline",onClick:()=>x(!1),className:"w-full sm:w-auto",children:"Batal"}),a.jsx(u,{variant:"destructive",onClick:P,disabled:y,className:"w-full sm:w-auto",children:y?"Menghapus...":"Hapus"})]})]})})]})}export{ma as default};
