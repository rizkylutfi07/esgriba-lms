var F=Object.defineProperty,K=Object.defineProperties;var D=Object.getOwnPropertyDescriptors;var _=Object.getOwnPropertySymbols;var L=Object.prototype.hasOwnProperty,M=Object.prototype.propertyIsEnumerable;var C=(r,i,t)=>i in r?F(r,i,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[i]=t,p=(r,i)=>{for(var t in i||(i={}))L.call(i,t)&&C(r,t,i[t]);if(_)for(var t of _(i))M.call(i,t)&&C(r,t,i[t]);return r},j=(r,i)=>K(r,D(i));var g=(r,i,t)=>new Promise((b,h)=>{var o=a=>{try{l(t.next(a))}catch(n){h(n)}},x=a=>{try{l(t.throw(a))}catch(n){h(n)}},l=a=>a.done?b(a.value):Promise.resolve(a.value).then(o,x);l((t=t.apply(r,i)).next())});import{j as e}from"./vendor-ui-XVksrZ5j.js";import{r as u}from"./vendor-react-DruPVAFJ.js";import{u as I,e as f,B as v,C as w,L as N,I as S}from"./index-BmVdEGiP.js";import{P}from"./plus-BcW2gs2h.js";import{B as J}from"./book-open-CXdsRrc-.js";import{P as q}from"./pen-square-DdkHHRrl.js";import{T as A}from"./trash-2-SALYx2gF.js";import"./vendor-utils-DI_-nBMo.js";import"./vendor-charts-BB9d_U7u.js";function W(){const[r,i]=u.useState([]),[t,b]=u.useState(!0),[h,o]=u.useState(!1),[x,l]=u.useState(null),[a,n]=u.useState({code:"",name:"",description:"",is_active:!0}),{toast:m}=I();u.useEffect(()=>{y()},[]);const y=()=>g(this,null,function*(){var s,d;try{const c=yield f.get("/majors");i(c.data.data)}catch(c){m({variant:"destructive",title:"Error",description:((d=(s=c.response)==null?void 0:s.data)==null?void 0:d.message)||"Gagal memuat data jurusan"})}finally{b(!1)}}),B=s=>g(this,null,function*(){var d,c;s.preventDefault();try{x?(yield f.put(`/majors/${x}`,a),m({title:"Berhasil",description:"Jurusan berhasil diupdate"})):(yield f.post("/majors",a),m({title:"Berhasil",description:"Jurusan berhasil ditambahkan"})),o(!1),l(null),n({code:"",name:"",description:"",is_active:!0}),y()}catch(k){m({variant:"destructive",title:"Error",description:((c=(d=k.response)==null?void 0:d.data)==null?void 0:c.message)||"Gagal menyimpan data"})}}),E=s=>{n({code:s.code,name:s.name,description:s.description||"",is_active:s.is_active}),l(s.id),o(!0)},T=s=>g(this,null,function*(){var d,c;if(confirm("Yakin ingin menghapus jurusan ini?"))try{yield f.delete(`/majors/${s}`),m({title:"Berhasil",description:"Jurusan berhasil dihapus"}),y()}catch(k){m({variant:"destructive",title:"Error",description:((c=(d=k.response)==null?void 0:d.data)==null?void 0:c.message)||"Gagal menghapus data"})}});return t?e.jsx("div",{className:"flex justify-center p-8",children:"Loading..."}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("h1",{className:"text-2xl font-bold",children:"Kelola Jurusan"}),e.jsxs(v,{onClick:()=>{o(!h),l(null),n({code:"",name:"",description:"",is_active:!0})},children:[e.jsx(P,{className:"mr-2 h-4 w-4"}),"Tambah Jurusan"]})]}),h&&e.jsxs(w,{className:"p-6",children:[e.jsx("h2",{className:"text-lg font-semibold mb-4",children:x?"Edit Jurusan":"Tambah Jurusan"}),e.jsxs("form",{onSubmit:B,className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(N,{htmlFor:"code",children:"Kode Jurusan *"}),e.jsx(S,{id:"code",value:a.code,onChange:s=>n(j(p({},a),{code:s.target.value.toUpperCase()})),placeholder:"TKR, TKJ, AKT",required:!0,maxLength:10})]}),e.jsxs("div",{children:[e.jsx(N,{htmlFor:"name",children:"Nama Jurusan *"}),e.jsx(S,{id:"name",value:a.name,onChange:s=>n(j(p({},a),{name:s.target.value})),placeholder:"Teknik Kendaraan Ringan",required:!0})]})]}),e.jsxs("div",{children:[e.jsx(N,{htmlFor:"description",children:"Deskripsi"}),e.jsx("textarea",{id:"description",className:"w-full min-h-[80px] px-3 py-2 border rounded-md",value:a.description,onChange:s=>n(j(p({},a),{description:s.target.value})),placeholder:"Deskripsi jurusan..."})]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx("input",{type:"checkbox",id:"is_active",checked:a.is_active,onChange:s=>n(j(p({},a),{is_active:s.target.checked})),className:"mr-2"}),e.jsx(N,{htmlFor:"is_active",children:"Aktif"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(v,{type:"submit",children:"Simpan"}),e.jsx(v,{type:"button",variant:"outline",onClick:()=>{o(!1),l(null)},children:"Batal"})]})]})]}),e.jsx("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-3",children:r.map(s=>e.jsxs(w,{className:"p-6",children:[e.jsxs("div",{className:"flex justify-between items-start mb-4",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(J,{className:"h-5 w-5 text-blue-500"}),e.jsx("h3",{className:"font-bold text-lg",children:s.code}),s.is_active&&e.jsx("span",{className:"px-2 py-0.5 bg-green-100 text-green-800 text-xs rounded",children:"Aktif"})]}),e.jsx("p",{className:"text-gray-600 mt-1",children:s.name})]}),e.jsxs("div",{className:"flex gap-1",children:[e.jsx(v,{size:"sm",variant:"outline",onClick:()=>E(s),children:e.jsx(q,{className:"h-4 w-4"})}),e.jsx(v,{size:"sm",variant:"destructive",onClick:()=>T(s.id),children:e.jsx(A,{className:"h-4 w-4"})})]})]}),s.description&&e.jsx("p",{className:"text-sm text-gray-500 mb-4",children:s.description}),e.jsxs("div",{className:"flex gap-4 text-sm text-gray-600 border-t pt-4",children:[e.jsxs("div",{children:[e.jsx("div",{className:"font-semibold",children:s.classes_count||0}),e.jsx("div",{children:"Kelas"})]}),e.jsxs("div",{children:[e.jsx("div",{className:"font-semibold",children:s.subjects_count||0}),e.jsx("div",{children:"Mapel"})]}),e.jsxs("div",{children:[e.jsx("div",{className:"font-semibold",children:s.users_count||0}),e.jsx("div",{children:"Siswa"})]})]})]},s.id))}),r.length===0&&e.jsxs(w,{className:"p-12 text-center text-gray-500",children:[e.jsx(J,{className:"h-12 w-12 mx-auto mb-4 opacity-50"}),e.jsx("p",{children:"Belum ada data jurusan"})]})]})}export{W as default};
