var je=Object.defineProperty,be=Object.defineProperties;var fe=Object.getOwnPropertyDescriptors;var ee=Object.getOwnPropertySymbols;var ve=Object.prototype.hasOwnProperty,we=Object.prototype.propertyIsEnumerable;var se=(h,c,o)=>c in h?je(h,c,{enumerable:!0,configurable:!0,writable:!0,value:o}):h[c]=o,g=(h,c)=>{for(var o in c||(c={}))ve.call(c,o)&&se(h,o,c[o]);if(ee)for(var o of ee(c))we.call(c,o)&&se(h,o,c[o]);return h},u=(h,c)=>be(h,fe(c));var _=(h,c,o)=>new Promise((E,l)=>{var n=w=>{try{F(o.next(w))}catch(T){l(T)}},D=w=>{try{F(o.throw(w))}catch(T){l(T)}},F=w=>w.done?E(w.value):Promise.resolve(w.value).then(n,D);F((o=o.apply(h,c)).next())});import{j as e}from"./vendor-ui-XVksrZ5j.js";import{r as j}from"./vendor-react-DruPVAFJ.js";import{A as Ne,D as ke}from"./data-table-qMSffp-C.js";import{B as v,u as ye,e as N,L as b,I as S}from"./index-BmVdEGiP.js";import{D as _e,a as Se,b as Ce,d as De,e as Ee,c as H}from"./dropdown-menu-BDf3JuuU.js";import{B as W}from"./badge-DVlZ2whw.js";import{M as Ie}from"./more-horizontal-B_tWyvgt.js";import{P as Fe}from"./pencil-DR_wvNsn.js";import{P as Te}from"./power-jHrPMCtu.js";import{T as Be}from"./trash-2-SALYx2gF.js";import{S as K,a as P,b as M,c as L,d as f}from"./select-CT0oUeJ5.js";import{D as ae,b as re,c as te,d as ie,e as le}from"./dialog-FHcYl0q1.js";import{P as Ae}from"./plus-BcW2gs2h.js";import{U as Y}from"./upload-BUKVXWUj.js";import{F as ne}from"./file-spreadsheet-BhItZ3XK.js";import{D as Oe}from"./download-Cc0AJeaF.js";import"./vendor-table-DRaoTYIa.js";import"./table-BTQg55BV.js";import"./chevron-left-Cico8d1J.js";import"./chevron-right-DGvanUYx.js";import"./vendor-utils-DI_-nBMo.js";import"./vendor-charts-BB9d_U7u.js";import"./check-BFyP0Qeo.js";import"./circle-B_uur8fk.js";import"./chevron-down-CL3T_hsi.js";const $e=(h,c,o,E)=>[{accessorKey:"name",header:({column:l})=>e.jsxs(v,{variant:"ghost",onClick:()=>l.toggleSorting(l.getIsSorted()==="asc"),className:"hover:bg-slate-100 dark:hover:bg-slate-800 text-xs sm:text-sm p-1 sm:p-4 h-auto",children:["Nama Siswa",e.jsx(Ne,{className:"ml-1 sm:ml-2 h-3 w-3 sm:h-4 sm:w-4"})]}),cell:({row:l})=>e.jsxs("div",{className:"font-medium text-slate-900 dark:text-white text-xs sm:text-sm min-w-[110px] max-w-[160px] sm:max-w-none",children:[e.jsx("div",{className:"truncate",children:l.getValue("name")}),e.jsx("div",{className:"text-[10px] sm:hidden text-slate-500 dark:text-slate-400 truncate mt-0.5",children:l.original.nisn||l.original.nis||"-"})]})},{accessorKey:"nisn",header:()=>e.jsx("div",{className:"text-xs sm:text-sm hidden sm:table-cell",children:"NISN"}),cell:({row:l})=>e.jsx("span",{className:"font-mono text-xs sm:text-sm text-slate-600 dark:text-slate-400 hidden sm:table-cell",children:l.getValue("nisn")||"-"})},{accessorKey:"email",header:()=>e.jsx("div",{className:"text-xs sm:text-sm hidden md:table-cell",children:"email"}),cell:({row:l})=>e.jsx("span",{className:"font-mono text-xs sm:text-sm text-slate-600 dark:text-slate-400 hidden md:table-cell",children:l.getValue("email")||"-"})},{accessorKey:"class.class_name",header:()=>e.jsx("div",{className:"text-xs sm:text-sm hidden md:table-cell",children:"Kelas"}),cell:({row:l})=>{const n=l.original.class;return e.jsx(W,{variant:"outline",className:"dark:border-slate-600 dark:text-slate-300 hidden md:inline-flex",children:n?n.class_name:"-"})}},{accessorKey:"major.major_name",header:()=>e.jsx("div",{className:"text-xs sm:text-sm hidden lg:table-cell",children:"Jurusan"}),cell:({row:l})=>{const n=l.original.major;return e.jsx("span",{className:"text-slate-600 dark:text-slate-400 hidden lg:inline",children:n?n.name:"-"})}},{accessorKey:"gender",header:()=>e.jsx("div",{className:"text-xs sm:text-sm hidden md:table-cell",children:"JK"}),cell:({row:l})=>{const n=l.getValue("gender");return e.jsx(W,{variant:n==="L"?"default":"secondary",className:"dark:border-slate-600 hidden md:inline-flex",children:n==="L"?"L":n==="P"?"P":"-"})}},{accessorKey:"is_active",header:()=>e.jsx("div",{className:"text-xs sm:text-sm hidden lg:table-cell",children:"Status"}),cell:({row:l})=>{const n=l.getValue("is_active");return e.jsx(W,{variant:n?"default":"secondary",className:`hidden lg:inline-flex ${n?"bg-green-100 text-green-800 border-green-300 dark:bg-green-900 dark:text-green-100":"bg-red-100 text-red-800 border-red-300 dark:bg-red-900 dark:text-red-100"}`,children:n?"Aktif":"Nonaktif"})}},{id:"actions",header:()=>e.jsx("div",{className:"text-xs sm:text-sm text-center",children:"Aksi"}),cell:({row:l})=>{const n=l.original;return e.jsx("div",{className:"flex justify-center",children:e.jsxs(_e,{children:[e.jsx(Se,{asChild:!0,children:e.jsxs(v,{variant:"ghost",className:"h-8 w-8 p-0 hover:bg-slate-100 dark:hover:bg-slate-800",children:[e.jsx("span",{className:"sr-only",children:"Open menu"}),e.jsx(Ie,{className:"h-4 w-4"})]})}),e.jsxs(Ce,{align:"end",className:"bg-white dark:bg-slate-900 border-slate-200 dark:border-slate-700 w-36",children:[e.jsx(De,{className:"dark:text-white text-xs",children:"Aksi"}),e.jsx(Ee,{className:"bg-slate-200 dark:bg-slate-700"}),o,e.jsxs(H,{onClick:()=>h(n),className:"cursor-pointer hover:bg-slate-100 dark:hover:bg-slate-800 dark:text-slate-200 text-xs",children:[e.jsx(Fe,{className:"mr-2 h-3 w-3"}),"Edit"]}),E&&e.jsxs(H,{onClick:()=>E(n),className:`cursor-pointer hover:bg-slate-100 dark:hover:bg-slate-800 text-xs ${n.is_active?"text-orange-600 dark:text-orange-400":"text-green-600 dark:text-green-400"}`,children:[e.jsx(Te,{className:"mr-2 h-3 w-3"}),n.is_active?"Nonaktifkan":"Aktifkan"]}),e.jsxs(H,{onClick:()=>c(n),className:"cursor-pointer text-red-600 dark:text-red-400 hover:bg-red-50 dark:hover:bg-red-950/30 text-xs",children:[e.jsx(Be,{className:"mr-2 h-3 w-3"}),"Hapus"]})]})]})})}}];function os(){const[h,c]=j.useState([]),[o,E]=j.useState([]),[l,n]=j.useState(!0),[D,F]=j.useState("all"),[w,T]=j.useState("all"),[de,R]=j.useState(!1),[B,U]=j.useState(null),[r,p]=j.useState({nisn:"",name:"",gender:"",birth_place:"",birth_date:"",nis:"",religion:"",address:"",class_id:"",email:"",password:"",password_confirmation:"",avatar:null}),[G,J]=j.useState(!1),{toast:x}=ye(),[oe,V]=j.useState(!1),[A,q]=j.useState(null),[I,z]=j.useState(!1),[m,O]=j.useState(null);j.useEffect(()=>{$(),ce()},[]);const $=()=>_(this,null,function*(){var s,t;try{const i=yield N.get("/users?role=siswa");c(i.data.data||[])}catch(i){console.error("Error fetching students:",i),x({title:"Error",description:((t=(s=i.response)==null?void 0:s.data)==null?void 0:t.message)||"Gagal memuat data siswa",variant:"destructive"})}finally{n(!1)}}),ce=()=>_(this,null,function*(){try{const s=yield N.get("/classes");E(s.data.data||[])}catch(s){console.error("Error fetching classes:",s)}}),Z=s=>{var t;s?(U(s),p({nisn:s.nisn||"",name:s.name||"",gender:s.gender||"",birth_place:s.birth_place||"",birth_date:s.birth_date?s.birth_date.includes("T")?s.birth_date.substring(0,10):s.birth_date:"",nis:s.nis||"",religion:s.religion||"",address:s.address||"",class_id:((t=s.class_id)==null?void 0:t.toString())||"",email:s.email||"",password:"",password_confirmation:"",avatar:null})):(U(null),p({nisn:"",name:"",gender:"",birth_place:"",birth_date:"",nis:"",religion:"",address:"",class_id:"",email:"",password:"",password_confirmation:"",avatar:null})),R(!0)},Q=()=>{R(!1),U(null)},me=s=>_(this,null,function*(){var t,i;s.preventDefault(),J(!0);try{if(B){if(r.avatar){const a=new FormData;a.append("_method","PUT"),a.append("nisn",r.nisn),a.append("name",r.name),a.append("gender",r.gender),a.append("birth_date",r.birth_date),a.append("birth_place",r.birth_place),a.append("nis",r.nis),a.append("religion",r.religion),a.append("address",r.address),a.append("class_id",r.class_id),a.append("email",r.email),a.append("role","siswa"),r.password&&(a.append("password",r.password),a.append("password_confirmation",r.password_confirmation)),a.append("avatar",r.avatar),yield N.post(`/users/${B.id}`,a,{headers:{"Content-Type":"multipart/form-data"}})}else{const a={nisn:r.nisn,name:r.name,gender:r.gender,birth_date:r.birth_date,birth_place:r.birth_place,nis:r.nis,religion:r.religion,address:r.address,class_id:parseInt(r.class_id),email:r.email,role:"siswa"};r.password&&(a.password=r.password,a.password_confirmation=r.password_confirmation),yield N.put(`/users/${B.id}`,a)}x({title:"Berhasil",description:"Data siswa berhasil diperbarui"})}else{const a=new FormData;a.append("nisn",r.nisn),a.append("name",r.name),a.append("gender",r.gender),a.append("birth_date",r.birth_date),a.append("birth_place",r.birth_place),a.append("nis",r.nis),a.append("religion",r.religion),a.append("address",r.address),a.append("class_id",r.class_id),a.append("email",r.email),a.append("role","siswa"),a.append("password",r.password),a.append("password_confirmation",r.password_confirmation),r.avatar&&a.append("avatar",r.avatar),yield N.post("/users",a,{headers:{"Content-Type":"multipart/form-data"}}),x({title:"Berhasil",description:"Siswa berhasil ditambahkan"})}$(),Q()}catch(a){console.error("Error saving student:",a),x({title:"Error",description:((i=(t=a.response)==null?void 0:t.data)==null?void 0:i.message)||"Gagal menyimpan data siswa",variant:"destructive"})}finally{J(!1)}}),he=s=>_(this,null,function*(){var t,i;if(confirm("Apakah Anda yakin ingin menghapus siswa ini?"))try{yield N.delete(`/users/${s}`),x({title:"Berhasil",description:"Siswa berhasil dihapus"}),$()}catch(a){console.error("Error deleting student:",a),x({title:"Error",description:((i=(t=a.response)==null?void 0:t.data)==null?void 0:i.message)||"Gagal menghapus siswa",variant:"destructive"})}}),pe=s=>_(this,null,function*(){var i,a;const t=s.is_active?"menonaktifkan":"mengaktifkan";if(confirm(`Apakah Anda yakin ingin ${t} siswa ${s.name}?`))try{yield N.post(`/users/${s.id}/toggle-active`),x({title:"Berhasil",description:`Siswa berhasil ${s.is_active?"dinonaktifkan":"diaktifkan"}`}),$()}catch(d){console.error("Error toggling student status:",d),x({title:"Error",description:((a=(i=d.response)==null?void 0:i.data)==null?void 0:a.message)||`Gagal ${t} siswa`,variant:"destructive"})}}),X=()=>_(this,null,function*(){var s,t;try{const i=yield N.get("/students/template",{responseType:"blob"}),a=window.URL.createObjectURL(new Blob([i.data])),d=document.createElement("a");d.href=a,d.setAttribute("download","template_import_siswa.xlsx"),document.body.appendChild(d),d.click(),d.remove(),x({title:"Berhasil",description:"Template berhasil didownload"})}catch(i){console.error("Error downloading template:",i),x({title:"Error",description:((t=(s=i.response)==null?void 0:s.data)==null?void 0:t.message)||"Gagal download template",variant:"destructive"})}}),xe=()=>_(this,null,function*(){var s,t;if(!A){x({title:"Error",description:"Silakan pilih file Excel terlebih dahulu",variant:"destructive"});return}z(!0),O(null);try{const i=new FormData;i.append("file",A);const a=yield N.post("/students/import",i,{headers:{"Content-Type":"multipart/form-data"}});O(a.data),x({title:"Import Berhasil",description:`${a.data.stats.success} siswa berhasil diimport${a.data.stats.failed>0?`, ${a.data.stats.failed} gagal`:""}`}),$(),a.data.stats.failed===0&&setTimeout(()=>{V(!1),q(null),O(null)},3e3)}catch(i){console.error("Error importing:",i);const a=(s=i.response)==null?void 0:s.data;let d=[];a!=null&&a.errors&&(Array.isArray(a.errors)?d=a.errors:typeof a.errors=="object"&&(d=Object.entries(a.errors).map(([y,C])=>Array.isArray(C)?{field:y,message:C.join(", ")}:typeof C=="string"?{field:y,message:C}:{field:y,message:String(C)}))),O({message:(a==null?void 0:a.message)||"Import gagal",errors:d,stats:(a==null?void 0:a.stats)||null});let k=(a==null?void 0:a.message)||i.message||"Gagal mengimport data";((t=i.response)==null?void 0:t.status)===422&&d.length>0&&(k=`Validasi gagal: ${d.slice(0,3).map(y=>{var C;return y.message||((C=y.errors)==null?void 0:C[0])||String(y)}).join("; ")}`,d.length>3&&(k+=` dan ${d.length-3} error lainnya`)),x({title:"Error Import",description:k,variant:"destructive"})}finally{z(!1)}}),ge=()=>_(this,null,function*(){var s,t;try{const i={};D!=="all"&&(i.class_id=D);const a=yield N.get("/students/export",{params:i,responseType:"blob"}),d=window.URL.createObjectURL(new Blob([a.data])),k=document.createElement("a");k.href=d;const y=`data_siswa_${new Date().toISOString().split("T")[0]}.xlsx`;k.setAttribute("download",y),document.body.appendChild(k),k.click(),k.remove(),x({title:"Berhasil",description:"Data siswa berhasil diexport"})}catch(i){console.error("Error exporting students:",i),x({title:"Error",description:((t=(s=i.response)==null?void 0:s.data)==null?void 0:t.message)||"Gagal export data",variant:"destructive"})}}),ue=h.filter(s=>{var a;const t=D==="all"||((a=s.class_id)==null?void 0:a.toString())===D,i=w==="all"||(w==="active"?s.is_active:!s.is_active);return t&&i});return l?e.jsx("div",{className:"flex items-center justify-center min-h-[400px]",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary mx-auto"}),e.jsx("p",{className:"mt-4 text-muted-foreground",children:"Memuat data..."})]})}):e.jsxs("div",{className:"space-y-4 p-3 sm:p-0 pb-20",children:[e.jsx("div",{className:"flex items-center justify-between gap-3 sm:gap-4 flex-wrap",children:e.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[e.jsxs(v,{className:"bg-orange-500 hover:bg-orange-600 text-white h-9 px-3 text-sm sm:h-10 sm:px-4",onClick:()=>Z(),children:[e.jsx(Ae,{className:"mr-2 h-4 w-4"}),e.jsx("span",{className:"hidden xs:inline",children:"Tambah Siswa"}),e.jsx("span",{className:"xs:hidden",children:"Tambah"})]}),e.jsxs(v,{className:"bg-green-600 hover:bg-green-700 text-white h-9 px-3 text-sm sm:h-10 sm:px-4",onClick:()=>V(!0),children:[e.jsx(Y,{className:"mr-2 h-4 w-4"}),e.jsx("span",{className:"hidden sm:inline",children:"Import Excel"}),e.jsx("span",{className:"sm:hidden",children:"Import"})]}),e.jsxs(v,{variant:"outline",className:"border-blue-500 text-blue-600 hover:bg-blue-50 h-9 px-3 text-sm sm:h-10 sm:px-4",onClick:X,children:[e.jsx(ne,{className:"mr-2 h-4 w-4"}),e.jsx("span",{className:"hidden sm:inline",children:"Download Template"}),e.jsx("span",{className:"sm:hidden",children:"Template"})]}),e.jsxs(v,{variant:"outline",className:"text-green-600 border-green-600 hover:bg-green-50 h-9 px-3 text-sm sm:h-10 sm:px-4",onClick:ge,title:"Export ke Excel",children:[e.jsx(Oe,{className:"h-4 w-4 mr-2"}),e.jsx("span",{className:"hidden sm:inline",children:"Export Excel"}),e.jsx("span",{className:"sm:hidden",children:"Export"})]}),e.jsxs(K,{value:D,onValueChange:F,children:[e.jsx(P,{className:"w-[160px] sm:w-[220px] h-9 sm:h-10 text-sm",children:e.jsx(M,{placeholder:"Semua Kelas"})}),e.jsxs(L,{children:[e.jsx(f,{value:"all",children:"Semua Kelas"}),o.map(s=>{var t;return e.jsxs(f,{value:s.id.toString(),children:[s.class_name," ",(t=s.major)!=null&&t.name?`- ${s.major.name}`:""]},s.id)})]})]}),e.jsxs(K,{value:w,onValueChange:T,children:[e.jsx(P,{className:"w-[130px] sm:w-[180px] h-9 sm:h-10 text-sm",children:e.jsx(M,{placeholder:"Status"})}),e.jsxs(L,{children:[e.jsx(f,{value:"all",children:"Semua Status"}),e.jsx(f,{value:"active",children:"Aktif"}),e.jsx(f,{value:"inactive",children:"Tidak Aktif"})]})]})]})}),e.jsx(ke,{columns:$e(s=>Z(s),s=>he(s.id),void 0,s=>pe(s)),data:ue,searchKey:"name",searchPlaceholder:"Cari siswa berdasarkan nama..."}),e.jsx(ae,{open:de,onOpenChange:R,children:e.jsxs(re,{className:"w-[95vw] sm:max-w-4xl max-h-[90vh] overflow-y-auto",children:[e.jsxs(te,{children:[e.jsx(ie,{children:B?"Edit Data Siswa":"Tambah Data Siswa"}),e.jsx(le,{children:B?"Perbarui informasi siswa":"Tambahkan siswa baru ke sistem"})]}),e.jsx("div",{className:"py-4",children:e.jsxs("form",{onSubmit:me,children:[e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-x-6 gap-y-4",children:[e.jsxs("div",{children:[e.jsxs(b,{htmlFor:"nisn",children:["NISN",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx(S,{id:"nisn",value:r.nisn,onChange:s=>p(u(g({},r),{nisn:s.target.value})),required:!0,className:"mt-1",placeholder:"0051494556"})]}),e.jsxs("div",{className:"row-span-4",children:[e.jsxs(b,{htmlFor:"address",children:["Alamat",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("textarea",{id:"address",value:r.address,onChange:s=>p(u(g({},r),{address:s.target.value})),required:!0,className:"w-full h-[220px] mt-1 px-3 py-2 border border-input rounded-md resize-none focus:outline-none focus:ring-2 focus:ring-blue-500 bg-background text-foreground dark:bg-slate-900 dark:text-white dark:border-slate-700",placeholder:"Dsn. Aseman RT 002 RW 003 Bimorejo Wongsorejo Banyuwangi"})]}),e.jsxs("div",{children:[e.jsxs(b,{htmlFor:"name",children:["Nama",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx(S,{id:"name",value:r.name,onChange:s=>p(u(g({},r),{name:s.target.value})),required:!0,className:"mt-1",placeholder:"ABDUL AZIZ"})]}),e.jsxs("div",{children:[e.jsxs(b,{htmlFor:"gender",children:["Jenis Kelamin",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs(K,{value:r.gender,onValueChange:s=>p(u(g({},r),{gender:s})),children:[e.jsx(P,{className:"mt-1",children:e.jsx(M,{placeholder:"Pilih"})}),e.jsxs(L,{children:[e.jsx(f,{value:"L",children:"Laki-laki"}),e.jsx(f,{value:"P",children:"Perempuan"})]})]})]}),e.jsxs("div",{children:[e.jsxs(b,{htmlFor:"birth_place",children:["Tempat Lahir",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx(S,{id:"birth_place",value:r.birth_place,onChange:s=>p(u(g({},r),{birth_place:s.target.value})),required:!0,className:"mt-1",placeholder:"Banyuwangi"})]}),e.jsxs("div",{children:[e.jsxs(b,{htmlFor:"class_id",children:["Kelas",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs(K,{value:r.class_id,onValueChange:s=>p(u(g({},r),{class_id:s})),children:[e.jsx(P,{className:"mt-1",children:e.jsx(M,{placeholder:"Pilih Kelas"})}),e.jsx(L,{children:o.map(s=>{var t;return e.jsxs(f,{value:s.id.toString(),children:[s.class_name," ",(t=s.major)!=null&&t.name?`- ${s.major.name}`:""]},s.id)})})]})]}),e.jsxs("div",{children:[e.jsxs(b,{htmlFor:"birth_date",children:["Tanggal Lahir",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx(S,{id:"birth_date",type:"date",value:r.birth_date,onChange:s=>p(u(g({},r),{birth_date:s.target.value})),required:!0,className:"mt-1"})]}),e.jsxs("div",{children:[e.jsx(b,{htmlFor:"email",children:"Email (Optional)"}),e.jsx(S,{id:"email",type:"email",value:r.email,onChange:s=>p(u(g({},r),{email:s.target.value})),className:"mt-1",placeholder:"siswa@cbt.com"})]}),e.jsxs("div",{children:[e.jsxs(b,{htmlFor:"nis",children:["NIS",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx(S,{id:"nis",value:r.nis,onChange:s=>p(u(g({},r),{nis:s.target.value})),required:!0,className:"mt-1",placeholder:"2764/0048/066"})]}),e.jsxs("div",{children:[e.jsx(b,{htmlFor:"avatar",children:"Foto (Optional)"}),e.jsxs("div",{className:"mt-1 flex items-center gap-2",children:[e.jsx(v,{type:"button",className:"bg-orange-500 hover:bg-orange-600 text-white px-4 py-2",onClick:()=>{var s;return(s=document.getElementById("avatar-input"))==null?void 0:s.click()},children:"Pilih File"}),e.jsx("input",{id:"avatar-input",type:"file",accept:"image/*",className:"hidden",onChange:s=>{var t;return p(u(g({},r),{avatar:((t=s.target.files)==null?void 0:t[0])||null}))}}),e.jsx("span",{className:"text-sm text-gray-500",children:r.avatar?r.avatar.name:"Tidak ada file dipilih"})]})]}),e.jsxs("div",{children:[e.jsxs(b,{htmlFor:"religion",children:["Agama",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs(K,{value:r.religion,onValueChange:s=>p(u(g({},r),{religion:s})),children:[e.jsx(P,{className:"mt-1",children:e.jsx(M,{placeholder:"Pilih Agama"})}),e.jsxs(L,{children:[e.jsx(f,{value:"Islam",children:"Islam"}),e.jsx(f,{value:"Kristen",children:"Kristen"}),e.jsx(f,{value:"Katolik",children:"Katolik"}),e.jsx(f,{value:"Hindu",children:"Hindu"}),e.jsx(f,{value:"Buddha",children:"Buddha"}),e.jsx(f,{value:"Konghucu",children:"Konghucu"})]})]})]}),e.jsxs("div",{children:[e.jsx(b,{htmlFor:"password",children:"Password Baru"}),e.jsx(S,{id:"password",type:"password",value:r.password,onChange:s=>p(u(g({},r),{password:s.target.value})),className:"mt-1",placeholder:"â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢"})]}),e.jsxs("div",{children:[e.jsx(b,{htmlFor:"password_confirmation",children:"Konfirmasi Password Baru"}),e.jsx(S,{id:"password_confirmation",type:"password",value:r.password_confirmation,onChange:s=>p(u(g({},r),{password_confirmation:s.target.value})),className:"mt-1",placeholder:"Masukkan ulang password"})]})]}),e.jsxs("div",{className:"flex flex-col-reverse sm:flex-row justify-end gap-2 mt-6",children:[e.jsx(v,{type:"button",variant:"outline",onClick:Q,disabled:G,className:"border-orange-500 text-orange-500 hover:bg-orange-50 w-full sm:w-auto",children:"Batal"}),e.jsx(v,{type:"submit",disabled:G,className:"bg-gray-500 hover:bg-gray-600 text-white w-full sm:w-auto",children:G?"Menyimpan...":"Simpan"})]})]})})]})}),e.jsx(ae,{open:oe,onOpenChange:V,children:e.jsxs(re,{className:"w-[95vw] sm:max-w-[600px]",children:[e.jsxs(te,{children:[e.jsxs(ie,{className:"flex items-center gap-2",children:[e.jsx(Y,{className:"h-5 w-5 text-green-600"}),"Import Data Siswa dari Excel"]}),e.jsx(le,{children:"Upload file Excel (.xlsx atau .xls) untuk import data siswa secara massal"})]}),e.jsxs("div",{className:"space-y-4 py-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(b,{htmlFor:"import-file",children:"Pilih File Excel"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(S,{id:"import-file",type:"file",accept:".xlsx,.xls",onChange:s=>{var t;return q(((t=s.target.files)==null?void 0:t[0])||null)},disabled:I,className:"flex-1"}),e.jsxs(v,{variant:"outline",onClick:X,disabled:I,className:"whitespace-nowrap",children:[e.jsx(ne,{className:"mr-2 h-4 w-4"}),"Template"]})]}),A&&e.jsxs("p",{className:"text-sm text-green-600",children:["âœ“ File dipilih: ",A.name]})]}),e.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4 space-y-2",children:[e.jsx("h4",{className:"font-semibold text-blue-900 text-sm",children:"ðŸ“‹ Format Data Excel:"}),e.jsxs("ul",{className:"text-sm text-blue-800 space-y-1 ml-4 list-disc",children:[e.jsxs("li",{children:[e.jsx("strong",{children:"nama"})," - Wajib diisi"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"email"})," - Wajib diisi, harus unique"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"nis"})," - Optional, harus unique jika diisi"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"password"})," - Optional (default: password123)"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"kelas"})," - Optional, auto-create jika baru"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"jurusan"})," - Optional, auto-create jika baru"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"status"})," - Optional (aktif/nonaktif)"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"agama"})," - Optional (bisa juga gunakan kolom",e.jsx("em",{children:" religion"}),")"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"tempat_lahir"})," - Optional (bisa juga gunakan"," ",e.jsx("em",{children:"birth_place"}),")"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"tanggal_lahir"})," - Optional (bisa juga gunakan"," ",e.jsx("em",{children:"birth_date"}),"), format disarankan YYYY-MM-DD atau tanggal Excel"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"alamat"})," - Optional (bisa juga gunakan",e.jsx("em",{children:" address"}),")"]})]})]}),m&&e.jsxs("div",{className:`rounded-lg p-4 space-y-2 ${m.stats?m.stats.failed>0?"bg-yellow-50 border border-yellow-200":"bg-green-50 border border-green-200":"bg-red-50 border border-red-200"}`,children:[e.jsx("h4",{className:`font-semibold text-sm ${m.stats?m.stats.failed>0?"text-yellow-900":"text-green-900":"text-red-900"}`,children:m.stats?m.stats.failed>0?"âš ï¸ Import Selesai dengan Beberapa Error":"âœ… Import Berhasil!":"âŒ Import Gagal"}),m.stats&&e.jsxs("div",{className:"text-sm space-y-1",children:[e.jsxs("p",{className:"text-green-700",children:["âœ“ Berhasil: ",m.stats.success," siswa"]}),m.stats.failed>0&&e.jsxs("p",{className:"text-red-700",children:["âœ— Gagal: ",m.stats.failed," siswa"]})]}),m.errors&&m.errors.length>0&&e.jsxs("div",{className:"mt-3 max-h-40 overflow-y-auto",children:[e.jsx("p",{className:"text-sm font-semibold text-red-800 mb-2",children:"Detail Error:"}),e.jsxs("div",{className:"space-y-2",children:[m.errors.slice(0,5).map((s,t)=>{var d;let i="",a="";return typeof s=="string"?a=s:s.row?(i=`Baris ${s.row}`,a=((d=s.errors)==null?void 0:d.join(", "))||s.error||s.message||String(s),s.attribute&&(a=`${s.attribute}: ${a}`)):s.field?(i=s.field,a=s.message||String(s)):s.error||s.errors?a=s.error||(Array.isArray(s.errors)?s.errors.join(", "):String(s.errors)):a=String(s),e.jsxs("div",{className:"text-xs bg-white p-2 rounded border border-red-200",children:[i&&e.jsx("p",{className:"font-semibold text-red-700",children:i}),e.jsx("p",{className:"text-red-600",children:a})]},t)}),m.errors.length>5&&e.jsxs("p",{className:"text-xs text-gray-600 italic",children:["...dan ",m.errors.length-5," error lainnya"]})]})]})]}),I&&e.jsxs("div",{className:"flex items-center justify-center py-4",children:[e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-green-600"}),e.jsx("span",{className:"ml-3 text-sm text-gray-600",children:"Mengimport data..."})]})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row justify-end gap-2",children:[e.jsx(v,{variant:"outline",onClick:()=>{V(!1),q(null),O(null)},disabled:I,className:"w-full sm:w-auto",children:m?"Tutup":"Batal"}),e.jsx(v,{className:"bg-green-600 hover:bg-green-700 text-white",onClick:xe,disabled:!A||I,children:I?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"}),"Importing..."]}):e.jsxs(e.Fragment,{children:[e.jsx(Y,{className:"mr-2 h-4 w-4"}),"Import Sekarang"]})})]})]})})]})}export{os as default};
