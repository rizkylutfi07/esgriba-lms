var I=Object.defineProperty,P=Object.defineProperties;var G=Object.getOwnPropertyDescriptors;var k=Object.getOwnPropertySymbols;var H=Object.prototype.hasOwnProperty,M=Object.prototype.propertyIsEnumerable;var w=(i,t,r)=>t in i?I(i,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):i[t]=r,u=(i,t)=>{for(var r in t||(t={}))H.call(t,r)&&w(i,r,t[r]);if(k)for(var r of k(t))M.call(t,r)&&w(i,r,t[r]);return i},h=(i,t)=>P(i,G(t));var f=(i,t,r)=>new Promise((_,p)=>{var S=d=>{try{o(r.next(d))}catch(a){p(a)}},m=d=>{try{o(r.throw(d))}catch(a){p(a)}},o=d=>d.done?_(d.value):Promise.resolve(d.value).then(S,m);o((r=r.apply(i,t)).next())});import{j as e}from"./vendor-ui-XVksrZ5j.js";import{r as x}from"./vendor-react-DruPVAFJ.js";import{u as z,B as j,C as J,a as O,b as q,d as A,L as v,I as g}from"./index-BmVdEGiP.js";import{D as F,b as K,c as R,d as U}from"./dialog-FHcYl0q1.js";import{S as $}from"./switch-DIYy5p1r.js";import{s as b}from"./sessionService-kbAHTHzL.js";import{P as Q}from"./plus-BcW2gs2h.js";import{P as V}from"./pen-square-DdkHHRrl.js";import{T as W}from"./trash-2-SALYx2gF.js";import"./vendor-utils-DI_-nBMo.js";import"./vendor-charts-BB9d_U7u.js";function oe(){var N,y;const{toast:i}=z(),[t,r]=x.useState([]),[_,p]=x.useState(!0),[S,m]=x.useState(!1),[o,d]=x.useState(null),[a,c]=x.useState({number:void 0,label:"",start_time:"08:00",end_time:"09:30",duration_minutes:void 0,is_active:!0}),C=()=>f(this,null,function*(){var s,n;try{p(!0);const l=yield b.list();r(l)}catch(l){i({title:"Error",description:((n=(s=l.response)==null?void 0:s.data)==null?void 0:n.message)||"Gagal memuat sesi",variant:"destructive"})}finally{p(!1)}});x.useEffect(()=>{C()},[]);const E=()=>{d(null),c({number:void 0,label:"",start_time:"08:00",end_time:"09:30",duration_minutes:void 0,is_active:!0}),m(!0)},D=s=>{var n,l;d(s),c({number:(n=s.number)!=null?n:void 0,label:s.label,start_time:s.start_time,end_time:s.end_time,duration_minutes:(l=s.duration_minutes)!=null?l:void 0,is_active:s.is_active}),m(!0)},T=()=>f(this,null,function*(){var s,n;try{if(!a.label){i({title:"Error",description:"Label sesi wajib diisi",variant:"destructive"});return}o?(yield b.update(o.id,a),i({title:"Berhasil",description:"Sesi diperbarui"})):(yield b.create(a),i({title:"Berhasil",description:"Sesi dibuat"})),m(!1),C()}catch(l){i({title:"Error",description:((n=(s=l.response)==null?void 0:s.data)==null?void 0:n.message)||"Gagal menyimpan sesi",variant:"destructive"})}}),B=s=>f(this,null,function*(){var n,l;if(confirm("Hapus sesi ini?"))try{yield b.delete(s),i({title:"Berhasil",description:"Sesi dihapus"}),C()}catch(L){i({title:"Error",description:((l=(n=L.response)==null?void 0:n.data)==null?void 0:l.message)||"Gagal menghapus sesi",variant:"destructive"})}});return e.jsxs("div",{className:"space-y-4 p-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h1",{className:"text-2xl font-bold",children:"Kelola Sesi Ujian"}),e.jsxs(j,{onClick:E,children:[e.jsx(Q,{className:"w-4 h-4 mr-2"}),"Tambah Sesi"]})]}),e.jsxs(J,{children:[e.jsx(O,{children:e.jsx(q,{children:"Daftar Sesi"})}),e.jsx(A,{children:_?e.jsx("p",{children:"Memuat..."}):t.length===0?e.jsx("p",{children:"Belum ada sesi"}):e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:t.map(s=>e.jsxs("div",{className:"border rounded-md p-3 flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"font-semibold",children:[s.label,s.number?` (Sesi ${s.number})`:""]}),e.jsxs("div",{className:"text-sm text-muted-foreground",children:[s.start_time," - ",s.end_time," â€¢ Durasi"," ",s.duration_minutes," menit"]}),!s.is_active&&e.jsx("div",{className:"text-xs text-amber-600",children:"Nonaktif"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(j,{variant:"outline",size:"sm",onClick:()=>D(s),children:e.jsx(V,{className:"w-4 h-4"})}),e.jsx(j,{variant:"outline",size:"sm",onClick:()=>B(s.id),children:e.jsx(W,{className:"w-4 h-4"})})]})]},s.id))})})]}),e.jsx(F,{open:S,onOpenChange:m,children:e.jsxs(K,{children:[e.jsx(R,{children:e.jsx(U,{children:o?"Edit Sesi":"Tambah Sesi"})}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("div",{children:[e.jsx(v,{children:"Nomor (opsional)"}),e.jsx(g,{type:"number",value:(N=a.number)!=null?N:"",onChange:s=>c(h(u({},a),{number:s.target.value?parseInt(s.target.value):void 0}))})]}),e.jsxs("div",{className:"col-span-1",children:[e.jsx(v,{children:"Label *"}),e.jsx(g,{value:a.label,onChange:s=>c(h(u({},a),{label:s.target.value})),placeholder:"Sesi 1"})]}),e.jsxs("div",{children:[e.jsx(v,{children:"Jam Mulai *"}),e.jsx(g,{type:"time",value:a.start_time,onChange:s=>c(h(u({},a),{start_time:s.target.value}))})]}),e.jsxs("div",{children:[e.jsx(v,{children:"Jam Selesai *"}),e.jsx(g,{type:"time",value:a.end_time,onChange:s=>c(h(u({},a),{end_time:s.target.value}))})]}),e.jsxs("div",{children:[e.jsx(v,{children:"Durasi (menit) (kosongkan untuk otomatis)"}),e.jsx(g,{type:"number",value:(y=a.duration_minutes)!=null?y:"",onChange:s=>c(h(u({},a),{duration_minutes:s.target.value?parseInt(s.target.value):void 0}))})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx($,{checked:!!a.is_active,onCheckedChange:s=>c(h(u({},a),{is_active:s}))}),e.jsx(v,{children:"Aktif"})]})]}),e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx(j,{variant:"outline",onClick:()=>m(!1),children:"Batal"}),e.jsx(j,{onClick:T,children:o?"Simpan":"Tambah"})]})]})})]})}export{oe as default};
